{"type":"file-history-snapshot","messageId":"0e65c8c3-050d-4833-829b-52bd337545f7","snapshot":{"messageId":"0e65c8c3-050d-4833-829b-52bd337545f7","trackedFileBackups":{},"timestamp":"2025-12-31T06:16:42.731Z"},"isSnapshotUpdate":false}
{"parentUuid":null,"isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","type":"user","message":{"role":"user","content":"Caveat: The messages below were generated by the user while running local commands. DO NOT respond to these messages or otherwise consider them in your response unless the user explicitly asks you to."},"isMeta":true,"uuid":"11c45826-8202-4207-a4d6-61b2e8480418","timestamp":"2025-12-31T06:16:42.730Z"}
{"parentUuid":"11c45826-8202-4207-a4d6-61b2e8480418","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","type":"user","message":{"role":"user","content":"<command-name>/model</command-name>\n            <command-message>model</command-message>\n            <command-args>opus</command-args>"},"uuid":"0e65c8c3-050d-4833-829b-52bd337545f7","timestamp":"2025-12-31T06:16:42.730Z"}
{"parentUuid":"0e65c8c3-050d-4833-829b-52bd337545f7","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","type":"user","message":{"role":"user","content":"<local-command-stdout>Set model to \u001b[1mopus (claude-opus-4-5-20251101)\u001b[22m</local-command-stdout>"},"uuid":"592de6ab-4ebe-4792-b577-98c321082383","timestamp":"2025-12-31T06:16:42.730Z"}
{"type":"file-history-snapshot","messageId":"a907f068-50b9-4c39-a3af-42c65ebed082","snapshot":{"messageId":"a907f068-50b9-4c39-a3af-42c65ebed082","trackedFileBackups":{},"timestamp":"2025-12-31T06:17:50.253Z"},"isSnapshotUpdate":false}
{"parentUuid":"592de6ab-4ebe-4792-b577-98c321082383","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","type":"user","message":{"role":"user","content":"~/Downloads/Payments Evolution.doc is the document covering the KT I received. Refine the attached doc. Ensure no detail is missed, and re-write it with similar format, but improve the language and sentences. Write an md file capturing these improved documentation"},"uuid":"a907f068-50b9-4c39-a3af-42c65ebed082","timestamp":"2025-12-31T06:17:50.244Z","thinkingMetadata":{"level":"high","disabled":false,"triggers":[]},"todos":[]}
{"parentUuid":"a907f068-50b9-4c39-a3af-42c65ebed082","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","message":{"model":"claude-opus-4-5-20251101","id":"msg_bdrk_013zhiwL78dzVee3vPgFQ2FC","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"The user wants me to read a document at ~/Downloads/Payments Evolution.doc, refine and improve it while maintaining the format and ensuring no details are missed, then write an improved version as a markdown file.\n\nLet me first read the document to understand its contents.","signature":"EroDCkgICxABGAIqQJz61yRTiOItS3SwdvuUxx39SaBpE6Jn+CKWpgJ+R60wVeQ72nKkAw/mmYvigBb5A9HRvvFzTc8f+BXYDUdbPzUSDMCXgHJp+izm65aocRoMMW+WXeF7hCwRw5eNIjCpJpfmq7a7nGK/6K6NlTHMIoy3QNvjsYdR1EpZn3OZztNJMfUxb09D8lGWxfygf5sqnwKKuNIgXt0+BWk+Wh+jLfHGS/liKDJPKLxnHWetGGzJ1Vp9Rq57ISvriuMyZnjgJ+Qn30kftQGuWPqbVtxI05KeUmDgZ+tBZNCX11/MIwrwJsdeU4QIIZdJdlZ8K+B0iBH3YLgVdQbDp6DV0uKYSHhg1Jwdxs34WGdbyAGnsySOVp4V61bI62fLgxjZl4+4tYwCmWQ/L55gCX82dxgVNSBwr+600Hani7vLuKe+QER2RYjM+x6Kp8XqWsQ9ZCX16WqD3sw/JEjgpgmNh8qcWg/HVRZj8GggqBHuzbz6hI753dxCsJlIHquGSKUQz/72ZxijD7JTBHVZ/vffargQDg+K1xTKIMjNI3MqjtYWFm3ssw06zZf6eQWW0X7fKdmg0xgB"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":9,"cache_creation_input_tokens":47831,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":47831,"ephemeral_1h_input_tokens":0},"output_tokens":6}},"type":"assistant","uuid":"7b5d3cf3-9e36-4ead-b22b-32e361a51da8","timestamp":"2025-12-31T06:17:55.979Z"}
{"parentUuid":"7b5d3cf3-9e36-4ead-b22b-32e361a51da8","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","message":{"model":"claude-opus-4-5-20251101","id":"msg_bdrk_013zhiwL78dzVee3vPgFQ2FC","type":"message","role":"assistant","content":[{"type":"text","text":"I'll read the document first to understand its contents."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":9,"cache_creation_input_tokens":47831,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":47831,"ephemeral_1h_input_tokens":0},"output_tokens":6}},"type":"assistant","uuid":"92aa024b-95c4-477e-8db2-43bb86c6bad5","timestamp":"2025-12-31T06:17:56.204Z"}
{"parentUuid":"92aa024b-95c4-477e-8db2-43bb86c6bad5","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","message":{"model":"claude-opus-4-5-20251101","id":"msg_bdrk_013zhiwL78dzVee3vPgFQ2FC","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_bdrk_01MmxGV6USGp4CCP7HLBFJSP","name":"Read","input":{"file_path":"/Users/kiranbiliyawala/Downloads/Payments Evolution.doc"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":9,"cache_creation_input_tokens":47831,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":47831,"ephemeral_1h_input_tokens":0},"output_tokens":145}},"type":"assistant","uuid":"d505143b-d9ea-444a-8b09-38a629b522ff","timestamp":"2025-12-31T06:17:56.620Z"}
{"parentUuid":"d505143b-d9ea-444a-8b09-38a629b522ff","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","type":"user","message":{"role":"user","content":[{"type":"tool_result","content":"<tool_use_error>This tool cannot read binary files. The file appears to be a binary .doc file. Please use appropriate tools for binary file analysis.</tool_use_error>","is_error":true,"tool_use_id":"toolu_bdrk_01MmxGV6USGp4CCP7HLBFJSP"}]},"uuid":"47e3bb20-f6a5-4044-a4ac-ef5430e9f428","timestamp":"2025-12-31T06:17:56.722Z","toolUseResult":"Error: This tool cannot read binary files. The file appears to be a binary .doc file. Please use appropriate tools for binary file analysis."}
{"parentUuid":"47e3bb20-f6a5-4044-a4ac-ef5430e9f428","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","message":{"model":"claude-opus-4-5-20251101","id":"msg_bdrk_0161QpcE6daHtug1mQFSMRTF","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"The file is a binary .doc file. I need to convert it to text first. Let me try using a command line tool to extract the text content. I can try using textutil on macOS to convert it.","signature":"EuECCkgICxABGAIqQIp1W21oyKlsHXGzj6CQCJjw4HmAr4FjwoSG+big9qTRbp9swsj4jYDDEdQmPUdTtIhcCPm+hVr17C9jM8pkCJgSDLx6z1ouWRTtUOtkIRoM4DnYz1xNIY2H1ufGIjDgTOwjbkmKdQS9h1mbMs9KZYyHnUF1iLWJdn8Squj5QVSePov+l4reKDW3ZOrhyfwqxgEL2AXShvJHR0i/1SoMkTUuGZoQGLJT7erRPqueHpNZXRvbv7V7iE1CwfRkMceSbKB6jupoyLdwnTIcRbp3vT+alt8Yr/zdICsAmk4oBaGzn6aVQbnOjHL5BjoEk2ObMRhIVJ3Z51JkSdN0yPJcxrv/iTQlI1hhlVvqgoxRQM9RESIcUZlJ38geWGg+5cr694jdeY+72pbF/SYKVlAp2REeun4jUAv3TqVreiyDAmA25NVlvkaqJpMT2QCbzCKVZYNil0z1x80YAQ=="}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":7,"cache_creation_input_tokens":211,"cache_read_input_tokens":47831,"cache_creation":{"ephemeral_5m_input_tokens":211,"ephemeral_1h_input_tokens":0},"output_tokens":1}},"type":"assistant","uuid":"02b8c6c1-dca2-42eb-a8d0-7912faef924e","timestamp":"2025-12-31T06:18:01.737Z"}
{"parentUuid":"02b8c6c1-dca2-42eb-a8d0-7912faef924e","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","message":{"model":"claude-opus-4-5-20251101","id":"msg_bdrk_0161QpcE6daHtug1mQFSMRTF","type":"message","role":"assistant","content":[{"type":"text","text":"The file is a binary .doc format. Let me convert it to extract the text content."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":7,"cache_creation_input_tokens":211,"cache_read_input_tokens":47831,"cache_creation":{"ephemeral_5m_input_tokens":211,"ephemeral_1h_input_tokens":0},"output_tokens":1}},"type":"assistant","uuid":"571271ab-d332-420d-b686-2a1343b92181","timestamp":"2025-12-31T06:18:01.948Z"}
{"parentUuid":"571271ab-d332-420d-b686-2a1343b92181","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","message":{"model":"claude-opus-4-5-20251101","id":"msg_bdrk_0161QpcE6daHtug1mQFSMRTF","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_bdrk_01NxHHrA3YEU2oCXBgrXmk9Z","name":"Bash","input":{"command":"textutil -convert txt -stdout ~/Downloads/\"Payments Evolution.doc\"","description":"Convert .doc file to text"}}],"stop_reason":"tool_use","stop_sequence":null,"usage":{"input_tokens":7,"cache_creation_input_tokens":211,"cache_read_input_tokens":47831,"cache_creation":{"ephemeral_5m_input_tokens":211,"ephemeral_1h_input_tokens":0},"output_tokens":162}},"type":"assistant","uuid":"4464fbc0-ef67-4812-8506-cdc5ae978be9","timestamp":"2025-12-31T06:18:02.671Z"}
{"parentUuid":"4464fbc0-ef67-4812-8506-cdc5ae978be9","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_bdrk_01NxHHrA3YEU2oCXBgrXmk9Z","type":"tool_result","content":"Date: Tue, 30 Dec 2025 12:36:33 +0000 (UTC)\r\nMessage-ID: <1563615915.1.1767098193993@de2f78ace265>\r\nSubject: Exported From Confluence\r\nMIME-Version: 1.0\r\nContent-Type: multipart/related; \r\n\tboundary=\"----=_Part_0_693573571.1767098193977\"\r\n\r\n------=_Part_0_693573571.1767098193977\r\nContent-Type: text/html; charset=UTF-8\r\nContent-Transfer-Encoding: quoted-printable\r\nContent-Location: file:///C:/exported.html\r\n\r\n<html xmlns:o=3D'urn:schemas-microsoft-com:office:office'\r\n      xmlns:w=3D'urn:schemas-microsoft-com:office:word'\r\n      xmlns:v=3D'urn:schemas-microsoft-com:vml'\r\n      xmlns=3D'urn:w3-org-ns:HTML'>\r\n<head>\r\n    <meta http-equiv=3D\"Content-Type\" content=3D\"text/html; charset=3Dutf-8=\r\n\">\r\n    <title>Payments Evolution</title>\r\n    <!--[if gte mso 9]>\r\n    <xml>\r\n        <o:OfficeDocumentSettings>\r\n            <o:TargetScreenSize>1024x640</o:TargetScreenSize>\r\n            <o:PixelsPerInch>72</o:PixelsPerInch>\r\n            <o:AllowPNG/>\r\n        </o:OfficeDocumentSettings>\r\n        <w:WordDocument>\r\n            <w:View>Print</w:View>\r\n            <w:Zoom>90</w:Zoom>\r\n            <w:DoNotOptimizeForBrowser/>\r\n        </w:WordDocument>\r\n    </xml>\r\n    <![endif]-->\r\n    <style>\r\n                <!--\r\n        @page Section1 {\r\n            size: 8.5in 11.0in;\r\n            margin: 1.0in;\r\n            mso-header-margin: .5in;\r\n            mso-footer-margin: .5in;\r\n            mso-paper-source: 0;\r\n        }\r\n\r\n        table {\r\n            border: solid 1px;\r\n            border-collapse: collapse;\r\n        }\r\n\r\n        table td, table th {\r\n            border: solid 1px;\r\n            padding: 5px;\r\n        }\r\n\r\n        td {\r\n            page-break-inside: avoid;\r\n        }\r\n\r\n        tr {\r\n            page-break-after: avoid;\r\n        }\r\n\r\n        div.Section1 {\r\n            page: Section1;\r\n        }\r\n\r\n        /* Confluence print stylesheet. Common to all themes for print medi=\r\na */\r\n/* Full of !important until we improve batching for print CSS */\r\n\r\n@media print {\r\n    #main {\r\n        padding-bottom: 1em !important; /* The default padding of 6em is to=\r\no much for printouts */\r\n    }\r\n\r\n    body {\r\n        font: var(--ds-font-body-small, Arial, Helvetica, FreeSans, sans-se=\r\nrif);\r\n    }\r\n\r\n    body, #full-height-container, #main, #page, #content, .has-personal-sid=\r\nebar #content {\r\n        background: var(--ds-surface, #fff) !important;\r\n        color: var(--ds-text, #000) !important;\r\n        border: 0 !important;\r\n        width: 100% !important;\r\n        height: auto !important;\r\n        min-height: auto !important;\r\n        margin: 0 !important;\r\n        padding: 0 !important;\r\n        display: block !important;\r\n    }\r\n\r\n    a, a:link, a:visited, a:focus, a:hover, a:active {\r\n        color: var(--ds-text, #000);\r\n    }\r\n\r\n    #content h1,\r\n    #content h2,\r\n    #content h3,\r\n    #content h4,\r\n    #content h5,\r\n    #content h6 {\r\n        page-break-after: avoid;\r\n    }\r\n\r\n    pre {\r\n        font: var(--ds-font-code, Monaco, \"Courier New\", monospace);\r\n    }\r\n\r\n    #header,\r\n    .aui-header-inner,\r\n    #navigation,\r\n    #sidebar,\r\n    .sidebar,\r\n    #personal-info-sidebar,\r\n    .ia-fixed-sidebar,\r\n    .page-actions,\r\n    .navmenu,\r\n    .ajs-menu-bar,\r\n    .noprint,\r\n    .inline-control-link,\r\n    .inline-control-link a,\r\n    a.show-labels-editor,\r\n    .global-comment-actions,\r\n    .comment-actions,\r\n    .quick-comment-container,\r\n    #addcomment {\r\n        display: none !important;\r\n    }\r\n\r\n    /* CONF-28544 cannot print multiple pages in IE */\r\n    #splitter-content {\r\n        position: relative !important;\r\n    }\r\n\r\n    .comment .date::before {\r\n        content: none !important; /* remove middot for print view */\r\n    }\r\n\r\n    h1.pagetitle img {\r\n        height: auto;\r\n        width: auto;\r\n    }\r\n\r\n    .print-only {\r\n        display: block;\r\n    }\r\n\r\n    #footer {\r\n        position: relative !important; /* CONF-17506 Place the footer at en=\r\nd of the content */\r\n        margin: 0;\r\n        padding: 0;\r\n        background: none;\r\n        clear: both;\r\n    }\r\n\r\n    #poweredby {\r\n        border-top: none;\r\n        background: none;\r\n    }\r\n\r\n    #poweredby li.print-only {\r\n        display: list-item;\r\n        font-style: italic;\r\n    }\r\n\r\n    #poweredby li.noprint {\r\n        display: none;\r\n    }\r\n\r\n    /* no width controls in print */\r\n    .wiki-content .table-wrap,\r\n    .wiki-content p,\r\n    .panel .codeContent,\r\n    .panel .codeContent pre,\r\n    .image-wrap {\r\n        overflow: visible !important;\r\n    }\r\n\r\n    /* TODO - should this work? */\r\n    #children-section,\r\n    #comments-section .comment,\r\n    #comments-section .comment .comment-body,\r\n    #comments-section .comment .comment-content,\r\n    #comments-section .comment p {\r\n        page-break-inside: avoid;\r\n    }\r\n\r\n    #page-children a {\r\n        text-decoration: none;\r\n    }\r\n\r\n    /**\r\n     hide twixies\r\n\r\n     the specificity here is a hack because print styles\r\n     are getting loaded before the base styles. */\r\n    #comments-section.pageSection .section-header,\r\n    #comments-section.pageSection .section-title,\r\n    #children-section.pageSection .section-header,\r\n    #children-section.pageSection .section-title,\r\n    .children-show-hide {\r\n        padding-left: 0;\r\n        margin-left: 0;\r\n    }\r\n\r\n    .children-show-hide.icon {\r\n        display: none;\r\n    }\r\n\r\n    /* personal sidebar */\r\n    .has-personal-sidebar #content {\r\n        margin-right: 0px;\r\n    }\r\n\r\n    .has-personal-sidebar #content .pageSection {\r\n        margin-right: 0px;\r\n    }\r\n\r\n    .no-print, .no-print * {\r\n        display: none !important;\r\n    }\r\n}\r\n-->\r\n    </style>\r\n</head>\r\n<body>\r\n    <h1>Payments Evolution</h1>\r\n    <div class=3D\"Section1\">\r\n        <h1 local-id=3D\"5093f077-cb74-49d8-b0d9-5afcff515be3\" id=3D\"Payment=\r\nsEvolution-Background\">Background</h1>\r\n<p local-id=3D\"0b09d8e6-1c35-4fea-82af-2049ce06637a\">When CRED started, we =\r\nhad <code>plutus</code> for transaction processing, acting as both order ma=\r\nnagement and transaction orchestrator.</p>\r\n<h2 local-id=3D\"3df2aadc-e74c-4f7f-a608-5834d2c96407\" id=3D\"PaymentsEvoluti=\r\non-Plutus\">Plutus</h2>\r\n<ol start=3D\"1\" local-id=3D\"0bff4ba3-d393-40a4-8dfc-a545bd8d07fb\">\r\n<li local-id=3D\"4dfeae7a-8eb2-4340-8d05-f4960375892a\">\r\n<p local-id=3D\"f1e914fc-17db-4bca-ad99-7c6652d16af7\"><code>Loading</code> a=\r\nnd <code>Fulfilment</code> are the key flows that plutus supports</p></li>\r\n<li local-id=3D\"60c2f563-7135-4ebe-84af-470c01371a2f\">\r\n<p local-id=3D\"9dff97a9-9e0a-43e5-bff9-6d469a32876d\"><code>Plutus</code> ha=\r\nd integration with Juspay=E2=80=99s express checkout for loading</p>\r\n<ol start=3D\"1\" local-id=3D\"140fcd7c-1d5f-4632-9fd8-132872254756\">\r\n<li local-id=3D\"323429c8-88ec-444f-a72e-704f5e2263de\">\r\n<p local-id=3D\"968c9199-3b1b-43cb-8722-3372f9d397e9\">Express checkout conne=\r\ncts with multiple partners. Eg. Rzp, PayU, Cashfree, etc</p></li>\r\n<li local-id=3D\"62e600a2-b911-4596-8565-7eb96b4c7520\">\r\n<p local-id=3D\"dd721e84-48fb-4d85-8c86-e503c7cfc77f\">Morpheus connects with=\r\n multiple partners. RBL, YBL</p></li>\r\n</ol></li>\r\n<li local-id=3D\"027fe507-31e2-4ac0-b5c4-816d3d483173\">\r\n<p local-id=3D\"49bff10e-2452-4bcf-a549-5a4147bea927\"><code>Plutus</code> ha=\r\nd integration with Juspay=E2=80=99s Morpheus for fulfilment</p></li>\r\n<li local-id=3D\"a25f8510-8590-442f-ab35-f73ee376432e\">\r\n<p local-id=3D\"26168a96-2115-4d66-9bc0-809ff2b9fd98\">After <code>darwin</co=\r\nde>(in house replacement of express checkout) and <code>genie</code>(in hou=\r\nse replacement of morpheus) got introduced, <code>plutus</code> would call =\r\ndarwin for loading first, and then genie for fulfilment.</p></li>\r\n<li local-id=3D\"e1a4a549-ca54-404c-9255-27407ca47a9a\">\r\n<p local-id=3D\"a837b9ee-04b1-4e7d-98ce-edea682b7475\">After both loading, an=\r\nd fulfilment are success, plutus gives success to lob.</p></li>\r\n<li local-id=3D\"ca76e9bc-f3bc-4406-8f72-6c3c597891b4\">\r\n<p local-id=3D\"deddb315-f682-46ae-bd31-2d3ab48759ad\">There were three types=\r\n of orders:</p>\r\n<ol start=3D\"1\" local-id=3D\"c19dbb13-d33b-4216-9792-2b299182aa3e\">\r\n<li local-id=3D\"ce4ab1db-20de-4406-b3d4-7a4897b7cc5b\">\r\n<p local-id=3D\"885bcf92-f937-44b6-810e-275fcfeb0e6f\">pay/loading only</p></=\r\nli>\r\n<li local-id=3D\"5abf0378-a938-45b6-a30c-f5182eacb5f1\">\r\n<p local-id=3D\"1299ba67-8d0e-49d6-bcef-a25865a1ff43\">loading &amp; fulfilme=\r\nnt: ccbp, bbps</p></li>\r\n<li local-id=3D\"5f5ab6d1-61a5-4435-bb20-c3c4c291d921\">\r\n<p local-id=3D\"f847df62-a018-485c-8380-f09733045ec8\">fulfilment only: cashb=\r\nacks to credit card</p></li>\r\n</ol></li>\r\n<li local-id=3D\"24b8d837-6e09-4fb5-a340-a8a83b11df6d\">\r\n<p local-id=3D\"53818137-22bb-4356-b1f3-2db6fdc989b9\">Plutus was multi-tenan=\r\nt.</p></li>\r\n<li local-id=3D\"09962095-0911-4583-b786-75537e250acb\">\r\n<p local-id=3D\"05bbf727-5121-435d-afc6-6340d5786316\">When fulfilment fails,=\r\n plutus would trigger the auto-refund of loaded amount.</p></li>\r\n</ol>\r\n<h2 local-id=3D\"08871f51-a3aa-477d-b6b2-962adaab1b4e\" id=3D\"PaymentsEvoluti=\r\non-Overall\">Overall</h2>\r\n<p local-id=3D\"7815f73f-f9b2-4016-8720-213a349f0421\">Payments has total of =\r\n4 steps:</p>\r\n<ol start=3D\"1\" local-id=3D\"353ee5ac-8ab1-48e1-9f3c-380cd55f469e\">\r\n<li local-id=3D\"cda50cb0-5813-4098-9289-38b481efb042\">\r\n<p local-id=3D\"0c7ad17f-d2e5-4922-b8da-c818e6e01d1a\">Merchant onboarding</p=\r\n></li>\r\n<li local-id=3D\"f5d6d865-3f4b-4486-bf8c-cbd034390fd6\">\r\n<p local-id=3D\"0c0ce13b-0156-4145-b3a1-4d8196ad0a1b\">Payment readiness</p><=\r\n/li>\r\n<li local-id=3D\"58be5d95-7252-464c-85eb-c982ddd0324f\">\r\n<p local-id=3D\"3782406a-ba05-4019-813d-2ccecd78ba81\">Payment processing</p>=\r\n</li>\r\n<li local-id=3D\"5dee8387-33fe-4df4-b69b-1960983a7e24\">\r\n<p local-id=3D\"ea8ad4c5-3b00-4afd-9942-c71fb8e4413c\">Post-payment: refund, =\r\nchargeback etc</p></li>\r\n</ol>\r\n<h1 local-id=3D\"5104f7a3-3019-4b85-83b4-c0e13c7469e6\" id=3D\"PaymentsEvoluti=\r\non-Paymentprocessing\">Payment processing</h1>\r\n<p local-id=3D\"89a1cfc9-4ae3-49bc-a152-f2c38b5db6ce\">There are two major co=\r\nmponents of payments processing:</p>\r\n<ol start=3D\"1\" local-id=3D\"10fa7dfe-8008-4902-8a2b-511af5180f08\">\r\n<li local-id=3D\"05d94061-b21d-403c-9cd9-4445820a5e1c\">\r\n<p local-id=3D\"c7cb34d5-cdf9-46b3-b532-9765ce0b8f19\">Instrument</p>\r\n<ol start=3D\"1\" local-id=3D\"3ac182db-b80b-4a26-91e1-b7ecebb1081b\">\r\n<li local-id=3D\"472a5826-5f21-4f1f-a936-615a78695222\">\r\n<p local-id=3D\"03193b74-06d8-4ec8-82f3-7303a99e2db0\">Storage: at user level=\r\n instruments</p></li>\r\n<li local-id=3D\"a91b6c7b-ea0b-4cd5-9bb7-1e25cdf4c8c3\">\r\n<p local-id=3D\"2fd0055c-8f57-4a0e-879f-e3716e3523a5\">Discovery: more of che=\r\nckout</p></li>\r\n<li local-id=3D\"c33f207c-16bd-46f0-bcc2-4033d39705cd\">\r\n<p local-id=3D\"cb938534-6533-405c-b72c-1454099a5c42\">Card tokenisation: thi=\r\ns is limited to card tokens only. If tomorrow other instruments needs to be=\r\n tokenised, things haven=E2=80=99t been thought through as of now. Liea is =\r\npositioned more as a card tokenisation</p></li>\r\n</ol></li>\r\n<li local-id=3D\"c3d5f40c-9c81-4193-8ca8-fed3a8235045\">\r\n<p local-id=3D\"f7294f27-fa28-49d0-96fe-c8728131a8b9\">Payments</p>\r\n<ol start=3D\"1\" local-id=3D\"4a1a9bde-ffc0-44d4-9f87-b19ce422044e\">\r\n<li local-id=3D\"31883b48-fe5d-41cb-8c6a-9646a8da1574\">\r\n<p local-id=3D\"325a3248-507f-49ca-9390-9fbe80a2011e\">Loading</p>\r\n<ol start=3D\"1\" local-id=3D\"302b5c31-6e05-4c22-b24c-97a3b3886f07\">\r\n<li local-id=3D\"3a838f5f-b6a0-44f1-8e99-744c68fb9fb4\">\r\n<p local-id=3D\"0cf1b7ca-de6c-4e91-9bbb-4c86e16fcea1\">Everything started as =\r\nloading via express checkout.</p></li>\r\n<li local-id=3D\"60e05e02-72c8-41b3-8b45-ac740c14ae2e\">\r\n<p local-id=3D\"d8228c80-0b9d-4eec-a503-f234a991602b\">Juspay had two configu=\r\nration models:</p>\r\n<ol start=3D\"1\" local-id=3D\"cbd604ea-245b-44a5-9715-d29da98852a7\">\r\n<li local-id=3D\"1b27b127-ffd2-4678-a996-b7d997a018fa\">\r\n<p local-id=3D\"07bc71f3-48be-4fdb-8354-9f89b766d786\">Configure at juspay=E2=\r\n=80=99s leg to select provider</p></li>\r\n<li local-id=3D\"5087a5e9-c247-468a-b59b-c547e48facbe\">\r\n<p local-id=3D\"bdf44f56-cf6b-42e3-83b3-e93c8ad2abe7\">Resolve the provider a=\r\nt client end, and share the provider in the request at transaction level.</=\r\np></li>\r\n</ol></li>\r\n<li local-id=3D\"90e3b949-034d-4c62-86b2-19e64422d5c8\">\r\n<p local-id=3D\"ee7467c4-df8a-450f-8bf3-68313df721b8\">Initially we started w=\r\nith first model, and then when we matured a little, we moved to second conf=\r\niguration model.</p></li>\r\n</ol></li>\r\n<li local-id=3D\"1dc0367e-ec57-4bf2-b215-262d17e718c5\">\r\n<p local-id=3D\"550277ba-e2ac-4000-b193-7bfc460c481a\">Fulfilment</p>\r\n<ol start=3D\"1\" local-id=3D\"af62b3f3-2730-4e42-a5e9-94d88e10869b\">\r\n<li local-id=3D\"8d676a60-5d32-4b24-94f6-922382ff5df1\">\r\n<p local-id=3D\"95f253d5-b62e-4f37-b68d-fd3cb017bc07\">Here things started as=\r\n Juspay=E2=80=99s Morpheus.</p></li>\r\n</ol></li>\r\n</ol></li>\r\n</ol>\r\n<h2 local-id=3D\"ef9b7e05-d136-47d0-b433-c2d7cbd92dd4\" id=3D\"PaymentsEvoluti=\r\non-Genie\">Genie</h2>\r\n<p local-id=3D\"97497e3e-7568-4710-9b35-6d6d1b6ec169\">The major problems we =\r\nface are more on fulfilment. We=E2=80=99re unable to fulfil promises, and e=\r\nnd up refunding etc. So we planned of moving fulfilment to in-house first. =\r\nAs a result genie was built. Genie is multi-tenant.</p>\r\n<ol start=3D\"1\" local-id=3D\"01632aca-09c0-42ea-9aed-69615f04301c\">\r\n<li local-id=3D\"91667d32-1e88-4223-8eac-a5eb82ee24c9\">\r\n<p local-id=3D\"480c9a54-ea24-4323-af7d-bb6795aaab40\">Genie has different pa=\r\nyout partners/provider, supporting multiple rails/channel.</p></li>\r\n<li local-id=3D\"9dcbe0dd-ed96-430c-8af5-ea21b94fe721\">\r\n<p local-id=3D\"0f640d56-52df-4eb1-92a6-df546e62f614\">Genie became the repla=\r\ncement of Morpheus.</p></li>\r\n<li local-id=3D\"96a0937a-c4a2-4dba-b783-23d9ce2cbcf3\">\r\n<p local-id=3D\"488ceb9e-17ef-4bfa-a9a7-ff18750ac274\">As part of migration <=\r\ncode>plutus</code> started calling <code>genie</code>, and <code>genie</cod=\r\ne> was calling <code>Morpheus</code>during migration.</p></li>\r\n<li local-id=3D\"fc1fe181-a1cd-4657-a0e3-f63d7da383d8\">\r\n<p local-id=3D\"7da56865-5430-4442-8a08-4c392b2356da\">Later on, it started i=\r\nntegrating with different partners.</p></li>\r\n<li local-id=3D\"8dd0cfd0-a7f7-4792-b253-3547dd874250\">\r\n<p local-id=3D\"cd20e0ce-2caa-47d7-ba91-ba4487bf738d\">Currently genie suppor=\r\nts 12-13 payout partners.</p></li>\r\n<li local-id=3D\"9ce7ee81-ab72-4b59-b58e-492237432ba1\">\r\n<p local-id=3D\"2230c138-b0e5-4df5-aa74-62165d786fcc\">Morpheus is no longer =\r\nexisting in our setup now.</p></li>\r\n<li local-id=3D\"f6d55dc6-ad67-43cc-82dd-c97e7f188606\">\r\n<p local-id=3D\"691bfb5a-8081-49b0-84d3-f9e312dabe94\">Genie is a dpspl offer=\r\ning for payout, and it is used by multiple tenants, where PA is one of thos=\r\ne tenants for payouts.</p></li>\r\n<li local-id=3D\"df40b75b-3cb2-4724-a8cc-611201e2745d\">\r\n<p local-id=3D\"f8793c45-260b-43bb-a4de-50e997e0aa44\">Genie is the only comp=\r\nonent who is involved in fund transfer</p></li>\r\n<li local-id=3D\"66a298ea-ca45-48e3-9bee-47f827fbf96f\">\r\n<p local-id=3D\"0bca6b6c-9362-42bd-bd32-ce2439765a0f\">Genie does not have ba=\r\nlance management of the banks.</p></li>\r\n<li local-id=3D\"6b3d92d3-04fd-4c1e-a03a-7636b72a4319\">\r\n<p local-id=3D\"483b9eb5-a111-4ab1-a6b1-84260785737b\">Genie expects that you=\r\n have a bank account, and I=E2=80=99m one of the parties who is authorized =\r\nto do the transfer.</p></li>\r\n</ol>\r\n<h2 local-id=3D\"62aef1a5-7bd3-439b-b559-85fdd1e7147a\" id=3D\"PaymentsEvoluti=\r\non-Darwin\">Darwin</h2>\r\n<p local-id=3D\"2846d7c7-d449-496a-9217-c7779a5fb22a\">Darwin is similar to g=\r\nenie for loading part. Darwin integrates with different providers, who it w=\r\nill integrate to get the money. Darwin is multi-tenant.</p>\r\n<ol start=3D\"1\" local-id=3D\"079d3002-c06f-4edb-80fb-b9cd60235cc4\">\r\n<li local-id=3D\"dac9db5e-9762-4970-aaa4-92d42c5d5d7d\">\r\n<p local-id=3D\"a03cffbd-91f6-469d-9d7e-26f4c3afd8df\">Provider=E2=80=99s def=\r\ninition is more of who has similar API structure/TSP.</p></li>\r\n<li local-id=3D\"4075faf0-d299-4dc8-a9e1-d2792a0c32b3\">\r\n<p local-id=3D\"850768cc-4948-4168-bc35-4b30320b53b4\">The same provider like=\r\n cybersource integration -</p>\r\n<ol start=3D\"1\" local-id=3D\"908402d6-f753-47ea-bd97-a7cb4cc03820\">\r\n<li local-id=3D\"b8da2130-d026-4099-b46a-bf785eb0ecd3\">\r\n<p local-id=3D\"9d6670c4-838f-4e07-84f0-4d717525948a\">Partner Axis can give =\r\nthe money using one credentials</p></li>\r\n<li local-id=3D\"ac76cbce-3d99-4807-a358-4fcb0a348ac7\">\r\n<p local-id=3D\"6536e96e-242d-4cb1-93ca-3a3a486313dc\">Partner YBL can give t=\r\nhe money using another credentials</p></li>\r\n</ol></li>\r\n<li local-id=3D\"0bfd16ec-00d3-4d67-bf91-01175242b79c\">\r\n<p local-id=3D\"edebf9ad-5e0b-420e-aa96-8b18451fb21e\">Similar to genie model=\r\n, we have Express Checkout also as another provider.</p></li>\r\n<li local-id=3D\"76ea568b-c28c-4b2e-8c68-1054c4d3a2b8\">\r\n<p local-id=3D\"afc87d0c-408e-411c-9c40-a04f48003f93\">Express checkout still=\r\n exist.</p></li>\r\n<li local-id=3D\"89ce4362-f58a-4828-b1a2-d87bec9356c5\">\r\n<p local-id=3D\"0f4cc36a-42a4-4ad4-b167-e3c4df46ba96\">Every time adding a ne=\r\nw provider needs a dev effort. So when the provider is small, and not much =\r\nROI, we use express checkout to simplify the onboarding.</p></li>\r\n</ol>\r\n<p local-id=3D\"c8b6d8b6-5740-4210-a39e-79a5970a6ecc\">Darwin has multiple Pa=\r\nyment Methods</p>\r\n<ol start=3D\"1\" local-id=3D\"19c1f69f-8dc3-4dcb-86a4-ad5cfaaf3e27\">\r\n<li local-id=3D\"59a24105-987a-463f-84a4-09e69a44b76b\">\r\n<p local-id=3D\"5ebb2d87-5acc-4aba-85fd-8fc2e5d96cb3\">C-UPI started growing =\r\nvery fast, and we had 60% CCBP started coming in from C-UPI.</p></li>\r\n<li local-id=3D\"0ef7c400-f706-4ad7-ab7b-3e20c074ed5a\">\r\n<p local-id=3D\"6e62b291-96dc-4c25-9b29-435053c4c866\">Darwin has different p=\r\nayment methods like CC, Net-Banking, DC, C-UPI, UPI(other apps).</p>\r\n<ol start=3D\"1\" local-id=3D\"b203cbbf-190b-4a06-b066-cf15e3592094\">\r\n<li local-id=3D\"182e4720-b849-4f79-8150-b90c90a17ebc\">\r\n<p local-id=3D\"08f852b0-9632-49ad-b3d5-faf70f56108a\">It added CUPI as a sep=\r\narate method, and interface for transacting is different, than normal UPI</=\r\np></li>\r\n<li local-id=3D\"dbc8158a-2bdf-43ea-bb87-821ab2a4137a\">\r\n<p local-id=3D\"792847c8-a7a4-42a0-94b1-2ea363d34bc7\">The reason to take thi=\r\ns decision was, so that experience, flows, and interfaces for CRED UPI vs o=\r\nther UPI apps.</p></li>\r\n</ol></li>\r\n</ol>\r\n<h3 local-id=3D\"1ad120a7-9182-4462-97ed-1d26efe6d52c\" id=3D\"PaymentsEvoluti=\r\non-MerchantPaymentOrchestrator\">Merchant Payment Orchestrator</h3>\r\n<p local-id=3D\"dc5c1970-8ce8-4a82-8e09-0007bf3fc566\">Given we did not want =\r\nto corrupt the darwin contracts, we introduced MPO as the wrapper layer on =\r\nDTPL side that acts makes it easy for CRED to integrate.</p>\r\n<p local-id=3D\"2d06402a-be94-4003-9bd2-b91102ff4042\">Majorly checkout, and =\r\nsome lobs who do not have checkout integrates with MPO. Currently, checkout=\r\n, cash, and wealth has integration with MPO.</p>\r\n<p local-id=3D\"4fed6bdd-d48c-46e2-86ba-0e24a68bf593\">Darwin is mostly backe=\r\nd by the MPO, direct use is rare. Limited to use cases like CRED QR etc.</p=\r\n>\r\n<h3 local-id=3D\"7d7f029c-f37f-4d69-a045-87fbd6446a6a\" id=3D\"PaymentsEvoluti=\r\non-ComponentX\">ComponentX</h3>\r\n<ul local-id=3D\"3864678e-c62d-4d91-9196-46f9b6d4f2af\">\r\n<li local-id=3D\"39bfb931-d0d6-444f-beb3-0eb950d0c273\">\r\n<p local-id=3D\"054e9e2a-4572-442c-99ff-bf1f6c5862de\">ComponentX is a monoli=\r\nth of SDKs.</p></li>\r\n<li local-id=3D\"dfaf0b3f-feb7-42f9-89c8-ce8953f7184d\">\r\n<p local-id=3D\"856e42fb-8abd-4802-a03c-576f564d78c1\">It decides when to inv=\r\noke which SDK, and orchestrates the flow to &amp; from SDKs.</p></li>\r\n<li local-id=3D\"bb50c0df-966b-45e5-a00d-aba8a707844c\">\r\n<p local-id=3D\"b452e440-ad56-4782-b748-55738d20462f\">It helps resolve diffe=\r\nrent UPI SDK flows.</p></li>\r\n</ul>\r\n<h1 local-id=3D\"b4e0f081-43f6-4a1e-8414-2396b6a31eb2\" id=3D\"PaymentsEvoluti=\r\non-BirthofPA\">Birth of PA</h1>\r\n<p local-id=3D\"cfa7c003-2dd6-44e5-b567-c787dd455143\">We had 30K crore of mo=\r\nnthly transacting amounts. At the time, we had nodal account to enable this=\r\n transfers.</p>\r\n<p local-id=3D\"4be64293-7f65-44f0-bd15-ae9553ed0435\">For any fund transfers=\r\n, where you don=E2=80=99t own the money, nodal account was used.</p>\r\n<p local-id=3D\"887a0546-e53d-478d-87ce-da0a1a47d14c\">From 2020 PA guideline=\r\ns, RBI barred nodal accounts. And recommends to use the escrow account.</p>\r\n<p local-id=3D\"ab7b2716-72ff-4b4f-b9f9-1ab55535bc79\">In escrow, most of the=\r\n money is not you own, only some part is what you own. Basis nature of your=\r\n business, only income part, for example MDR, fees, etc, can be part of esc=\r\nrow, else most of the money is something that is owned by your partners/cus=\r\ntomers</p>\r\n<p local-id=3D\"2b6852bd-e9f8-419f-9c7f-d7e883c3b189\">We can use the escrow =\r\naccount for tax payments of PA, but people prefer not to. They transfer mon=\r\ney to their current account for realising the income, and then do these tax=\r\n payments etc from current account itself.</p>\r\n<p local-id=3D\"babcab30-b7fb-46bd-a9fc-68e7d754290d\">Given, we were large b=\r\nusiness, and there was a regulatory risk in the absence, we applied for PA =\r\nlicense. We had two options:</p>\r\n<ol start=3D\"1\" local-id=3D\"62a2c887-221e-409c-94ec-447859201f58\">\r\n<li local-id=3D\"179c86b3-5d24-4a41-9c7f-525892d1ccc5\">\r\n<p local-id=3D\"5555addd-8ac5-4e27-bcc3-bacb7e6eaed4\">We apply as new entity=\r\n</p>\r\n<ol start=3D\"1\" local-id=3D\"88e29a26-6840-40ed-8c52-c7e47b4e68b1\">\r\n<li local-id=3D\"179c86b3-5d24-4a41-9c7f-525892d1ccc5\">\r\n<p local-id=3D\"c10a756d-3153-4565-81b2-e836b011788c\">If we apply as a new e=\r\nntity, RBI vets the whole company, processes, business etc before giving th=\r\ne license, and it brings more scrutiny.</p></li>\r\n</ol></li>\r\n<li local-id=3D\"0cfcb5fc-4dcc-4430-841a-a6d7d7a3dafe\">\r\n<p local-id=3D\"c728ed6c-168c-4199-bf24-9d686e0b2309\">We apply as existing c=\r\nompany.</p>\r\n<ol start=3D\"1\" local-id=3D\"bc2105f9-8d28-4389-ad3d-11606f172ad1\">\r\n<li local-id=3D\"4073d56f-0b81-4380-8ecb-38d421567812\">\r\n<p local-id=3D\"ddc06cce-e0fb-4c52-9d12-8cec8c26ba5e\">Here some business is =\r\nalready running, hence applying as existing company who has the PA business=\r\n is comparatively easier.</p></li>\r\n<li local-id=3D\"e6699c0f-e906-40ca-82e1-c0864470ed08\">\r\n<p local-id=3D\"769d16a3-8a7e-4600-8470-2cba905a86a7\">Hence we chose this pa=\r\nth, because we had the running business at the time.</p></li>\r\n<li local-id=3D\"d8bca08b-257b-4976-b0c7-f670b519f4a7\">\r\n<p local-id=3D\"2bd1cd53-34d6-4d08-93b3-566b8e89d03f\">We had some 30 nodal a=\r\nccounts at the time. And shared ccbp is the fund aggregator use case. This =\r\ngot signed off, that yes it is an existing entity.</p></li>\r\n</ol></li>\r\n</ol>\r\n<p local-id=3D\"75dcaf81-18db-4afd-9d69-31f8f1bd4d88\">We could have chosen t=\r\no make either DTPL as a PA entity, or create a new entity. We chose the pat=\r\nh of creating new entity DPSPL, to avoid customer facing company having any=\r\n regulatory scrutiny.</p>\r\n<p local-id=3D\"2a0f62bc-ee19-4324-97dd-e441fecc4dbc\">At the time, all the e=\r\nxisting service of plutus, darwin, genie etc were part of DTPL. Darwin, Gen=\r\nie, and card tokenisation/leia were recognised as PA components, we moved t=\r\nhese to DPSPL.</p>\r\n<p local-id=3D\"7721cced-a31e-4ec5-a7a8-b24ce2de54e8\">Plutus continued to ca=\r\nll darwin/genie etc in new dpspl environment. And bill payments were workin=\r\ng in this new setup. Other systems/components were built later on for other=\r\n merchants later on.</p>\r\n<h2 local-id=3D\"c6f37a46-0d7b-4df3-ae59-b7cf324a9401\" id=3D\"PaymentsEvoluti=\r\non-Narad\">Narad</h2>\r\n<ol start=3D\"1\" local-id=3D\"6d881051-98f6-4176-a261-e18969d71521\">\r\n<li local-id=3D\"398ca872-0cfa-4103-9f3c-ef61f238f58c\">\r\n<p local-id=3D\"9223332b-8985-4ade-88b7-b5239e176fb9\">near real time routing=\r\n logic</p></li>\r\n<li local-id=3D\"beeb7875-36fd-4c11-ab11-4d6c50975d1e\">\r\n<p local-id=3D\"7a836dc3-6b29-4415-a970-162295eddfb9\">it integrates with dow=\r\nntime detection models, and works on success rates etc</p></li>\r\n<li local-id=3D\"4581f095-8447-47b0-a138-feae62951fe7\">\r\n<p local-id=3D\"8a1635f7-105a-41bc-976f-a17c3e957218\">it routes to another p=\r\nrovider within 3 minutes when something starts failing</p></li>\r\n</ol>\r\n<h2 local-id=3D\"64c361f4-3ab9-4e34-8466-0da46daf075e\" id=3D\"PaymentsEvoluti=\r\non-Mandates\">Mandates</h2>\r\n<ul local-id=3D\"8a039ba6-e083-495b-918f-37f86a370186\">\r\n<li local-id=3D\"fd89cfe5-2287-4c51-90e4-f9ebe1e9c706\">\r\n<p local-id=3D\"26e7a37e-2a8d-4bb7-886a-6877f4e1efcf\">Originally only standa=\r\nrd payments were supported, for supporting mandates, mandate service is bui=\r\nlt.</p></li>\r\n<li local-id=3D\"2190a2bb-725f-4822-9325-d30318e6b399\">\r\n<p local-id=3D\"634d07c8-17a9-4228-8fae-38de34cfe4f2\">The nuances among darw=\r\nin and mandate service has very thin boundary, so externally its the same.<=\r\n/p></li>\r\n</ul>\r\n<h1 local-id=3D\"a2a2a60b-d092-4cae-a496-2aaa6e5c4cd3\" id=3D\"PaymentsEvoluti=\r\non-MerchantsasEntityinPA\">Merchants as Entity in PA</h1>\r\n<p local-id=3D\"91b87658-d0fe-4111-9da9-f5d4e401968c\">We have a merchant ser=\r\nvice for merchant onboarding/management, and we use jocata for AML flows.</=\r\np>\r\n<ul local-id=3D\"a117fe75-6123-4b55-acf9-b2587d8a0a3f\">\r\n<li local-id=3D\"73103de3-5548-47c9-b188-b83e52ee2bc4\">\r\n<p local-id=3D\"1b22b298-60e5-499e-b074-d37719e395b4\">Dunzo/Swiggy was one o=\r\nf the first merchants. Where we created the CRED Pay, and this dunzo/swiggy=\r\n became other merchants, other than DTPL(being used for bill payments).</p>=\r\n</li>\r\n<li local-id=3D\"03bfd6a3-1389-4b6b-a73c-8d93966c5f1e\">\r\n<p local-id=3D\"36facffd-5f5e-4396-8517-b3244c79695b\">Here, user flows, such=\r\n as instrument discovery, reward/offer, etc becomes key. This is solved usi=\r\nng heimdall from DTPL side, and darwin was helping solve the same on paymen=\r\nts side.</p></li>\r\n<li local-id=3D\"6763b626-c2b7-41ec-8696-3cb6d7dd3b56\">\r\n<p local-id=3D\"3e05e53a-cc05-46a1-b9a8-dd741838956d\">When the money hits th=\r\ne escrow account, someone needs to aggregate the amount per day, to compute=\r\n MDR, and then transfer the remaining to merchant. To support this, there w=\r\nas a configurable script was created for a merchant called SCAR. Originally=\r\n scar used heimdal and genie to identify the transactions to aggregate. Lat=\r\ner on settlement engine was created to replace this, and do it properly in =\r\ndpspl.</p></li>\r\n<li local-id=3D\"5b802b48-89be-42a9-bdd7-2ad9f4bcc239\">\r\n<p local-id=3D\"445b2f9d-850e-42ef-87e0-0af86e7ad091\">Settlement engine has =\r\nan accounting, that does the aggregation, computes fees using a fee rule en=\r\ngine using service called tyrion, and computes the amount to settle.</p></l=\r\ni>\r\n<li local-id=3D\"47a5cb5e-a2ef-42f9-ae4b-0481ec058df6\">\r\n<p local-id=3D\"834a0cd0-7f4d-4ebd-9156-985ab03d9414\">And finally genie is u=\r\nsed to do the settlement. Before settlement engine, scar also used genie on=\r\nly for the fund transfer.</p></li>\r\n<li local-id=3D\"10761f89-7120-49c9-b0b8-49dc3fffe718\">\r\n<p local-id=3D\"51b3cf80-0d7e-46de-8820-106cb404d4c3\">MCC is not standardise=\r\nd in industry, we have used npci mcc definition for our own mccs.</p></li>\r\n<li local-id=3D\"99ac1a7a-f2a4-4eb1-91ee-7aa6564809b4\">\r\n<p local-id=3D\"59997dc0-6f28-4ba0-a862-01e821e6d6bc\">As part of payment rea=\r\ndiness, as part of merchant onboarding, the configuration of MCC is created=\r\n for the supported payment instruments.</p></li>\r\n</ul>\r\n<h2 local-id=3D\"2583de3c-090f-44b2-a6eb-0ebf1a94b498\" id=3D\"PaymentsEvoluti=\r\non-LCM(LoadingCapabilityManager)\">LCM (Loading Capability Manager)</h2>\r\n<ul local-id=3D\"8bb73553-2512-4288-acd4-037a71c7dee2\">\r\n<li local-id=3D\"c34298cd-2d71-4b66-b3b6-315ef5102c41\">\r\n<p local-id=3D\"0ecb0c92-5989-43f7-866c-75791dbc79e2\">as part of merchant on=\r\nboarding, given mcc level type of payment instruments are configured, this =\r\nhelps validate which all instruments are allowed for a transaction/merchant=\r\n.</p></li>\r\n<li local-id=3D\"d792c654-f753-4e7f-80f0-409bacbddf14\">\r\n<p local-id=3D\"9f657d9e-515d-433a-9b62-0954ee1ab73d\">in the absence of LCM,=\r\n darwin was having routing logic for each merchant. And as part of this, th=\r\ne routing did not exist for unsupported instruments, and PA would fail the =\r\ntransaction if let say credit card is used for paying a loan.</p></li>\r\n<li local-id=3D\"99a98d1b-5c01-48ce-9632-8e85af1aa2fa\">\r\n<p local-id=3D\"49fcc8ce-77c9-4225-b962-ff3ccc3b2fe2\">for every new use case=\r\n we create a new terminal, and configure the same in lcm.</p></li>\r\n</ul>\r\n    </div>\r\n</body>\r\n</html>\r\n------=_Part_0_693573571.1767098193977--\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r100   120    0   120    0     0    322      0 --:--:-- --:--:-- --:--:--   322","is_error":false}]},"uuid":"f5dba820-7898-48c5-ba13-9ad16446a851","timestamp":"2025-12-31T06:18:14.405Z","toolUseResult":{"stdout":"Date: Tue, 30 Dec 2025 12:36:33 +0000 (UTC)\r\nMessage-ID: <1563615915.1.1767098193993@de2f78ace265>\r\nSubject: Exported From Confluence\r\nMIME-Version: 1.0\r\nContent-Type: multipart/related; \r\n\tboundary=\"----=_Part_0_693573571.1767098193977\"\r\n\r\n------=_Part_0_693573571.1767098193977\r\nContent-Type: text/html; charset=UTF-8\r\nContent-Transfer-Encoding: quoted-printable\r\nContent-Location: file:///C:/exported.html\r\n\r\n<html xmlns:o=3D'urn:schemas-microsoft-com:office:office'\r\n      xmlns:w=3D'urn:schemas-microsoft-com:office:word'\r\n      xmlns:v=3D'urn:schemas-microsoft-com:vml'\r\n      xmlns=3D'urn:w3-org-ns:HTML'>\r\n<head>\r\n    <meta http-equiv=3D\"Content-Type\" content=3D\"text/html; charset=3Dutf-8=\r\n\">\r\n    <title>Payments Evolution</title>\r\n    <!--[if gte mso 9]>\r\n    <xml>\r\n        <o:OfficeDocumentSettings>\r\n            <o:TargetScreenSize>1024x640</o:TargetScreenSize>\r\n            <o:PixelsPerInch>72</o:PixelsPerInch>\r\n            <o:AllowPNG/>\r\n        </o:OfficeDocumentSettings>\r\n        <w:WordDocument>\r\n            <w:View>Print</w:View>\r\n            <w:Zoom>90</w:Zoom>\r\n            <w:DoNotOptimizeForBrowser/>\r\n        </w:WordDocument>\r\n    </xml>\r\n    <![endif]-->\r\n    <style>\r\n                <!--\r\n        @page Section1 {\r\n            size: 8.5in 11.0in;\r\n            margin: 1.0in;\r\n            mso-header-margin: .5in;\r\n            mso-footer-margin: .5in;\r\n            mso-paper-source: 0;\r\n        }\r\n\r\n        table {\r\n            border: solid 1px;\r\n            border-collapse: collapse;\r\n        }\r\n\r\n        table td, table th {\r\n            border: solid 1px;\r\n            padding: 5px;\r\n        }\r\n\r\n        td {\r\n            page-break-inside: avoid;\r\n        }\r\n\r\n        tr {\r\n            page-break-after: avoid;\r\n        }\r\n\r\n        div.Section1 {\r\n            page: Section1;\r\n        }\r\n\r\n        /* Confluence print stylesheet. Common to all themes for print medi=\r\na */\r\n/* Full of !important until we improve batching for print CSS */\r\n\r\n@media print {\r\n    #main {\r\n        padding-bottom: 1em !important; /* The default padding of 6em is to=\r\no much for printouts */\r\n    }\r\n\r\n    body {\r\n        font: var(--ds-font-body-small, Arial, Helvetica, FreeSans, sans-se=\r\nrif);\r\n    }\r\n\r\n    body, #full-height-container, #main, #page, #content, .has-personal-sid=\r\nebar #content {\r\n        background: var(--ds-surface, #fff) !important;\r\n        color: var(--ds-text, #000) !important;\r\n        border: 0 !important;\r\n        width: 100% !important;\r\n        height: auto !important;\r\n        min-height: auto !important;\r\n        margin: 0 !important;\r\n        padding: 0 !important;\r\n        display: block !important;\r\n    }\r\n\r\n    a, a:link, a:visited, a:focus, a:hover, a:active {\r\n        color: var(--ds-text, #000);\r\n    }\r\n\r\n    #content h1,\r\n    #content h2,\r\n    #content h3,\r\n    #content h4,\r\n    #content h5,\r\n    #content h6 {\r\n        page-break-after: avoid;\r\n    }\r\n\r\n    pre {\r\n        font: var(--ds-font-code, Monaco, \"Courier New\", monospace);\r\n    }\r\n\r\n    #header,\r\n    .aui-header-inner,\r\n    #navigation,\r\n    #sidebar,\r\n    .sidebar,\r\n    #personal-info-sidebar,\r\n    .ia-fixed-sidebar,\r\n    .page-actions,\r\n    .navmenu,\r\n    .ajs-menu-bar,\r\n    .noprint,\r\n    .inline-control-link,\r\n    .inline-control-link a,\r\n    a.show-labels-editor,\r\n    .global-comment-actions,\r\n    .comment-actions,\r\n    .quick-comment-container,\r\n    #addcomment {\r\n        display: none !important;\r\n    }\r\n\r\n    /* CONF-28544 cannot print multiple pages in IE */\r\n    #splitter-content {\r\n        position: relative !important;\r\n    }\r\n\r\n    .comment .date::before {\r\n        content: none !important; /* remove middot for print view */\r\n    }\r\n\r\n    h1.pagetitle img {\r\n        height: auto;\r\n        width: auto;\r\n    }\r\n\r\n    .print-only {\r\n        display: block;\r\n    }\r\n\r\n    #footer {\r\n        position: relative !important; /* CONF-17506 Place the footer at en=\r\nd of the content */\r\n        margin: 0;\r\n        padding: 0;\r\n        background: none;\r\n        clear: both;\r\n    }\r\n\r\n    #poweredby {\r\n        border-top: none;\r\n        background: none;\r\n    }\r\n\r\n    #poweredby li.print-only {\r\n        display: list-item;\r\n        font-style: italic;\r\n    }\r\n\r\n    #poweredby li.noprint {\r\n        display: none;\r\n    }\r\n\r\n    /* no width controls in print */\r\n    .wiki-content .table-wrap,\r\n    .wiki-content p,\r\n    .panel .codeContent,\r\n    .panel .codeContent pre,\r\n    .image-wrap {\r\n        overflow: visible !important;\r\n    }\r\n\r\n    /* TODO - should this work? */\r\n    #children-section,\r\n    #comments-section .comment,\r\n    #comments-section .comment .comment-body,\r\n    #comments-section .comment .comment-content,\r\n    #comments-section .comment p {\r\n        page-break-inside: avoid;\r\n    }\r\n\r\n    #page-children a {\r\n        text-decoration: none;\r\n    }\r\n\r\n    /**\r\n     hide twixies\r\n\r\n     the specificity here is a hack because print styles\r\n     are getting loaded before the base styles. */\r\n    #comments-section.pageSection .section-header,\r\n    #comments-section.pageSection .section-title,\r\n    #children-section.pageSection .section-header,\r\n    #children-section.pageSection .section-title,\r\n    .children-show-hide {\r\n        padding-left: 0;\r\n        margin-left: 0;\r\n    }\r\n\r\n    .children-show-hide.icon {\r\n        display: none;\r\n    }\r\n\r\n    /* personal sidebar */\r\n    .has-personal-sidebar #content {\r\n        margin-right: 0px;\r\n    }\r\n\r\n    .has-personal-sidebar #content .pageSection {\r\n        margin-right: 0px;\r\n    }\r\n\r\n    .no-print, .no-print * {\r\n        display: none !important;\r\n    }\r\n}\r\n-->\r\n    </style>\r\n</head>\r\n<body>\r\n    <h1>Payments Evolution</h1>\r\n    <div class=3D\"Section1\">\r\n        <h1 local-id=3D\"5093f077-cb74-49d8-b0d9-5afcff515be3\" id=3D\"Payment=\r\nsEvolution-Background\">Background</h1>\r\n<p local-id=3D\"0b09d8e6-1c35-4fea-82af-2049ce06637a\">When CRED started, we =\r\nhad <code>plutus</code> for transaction processing, acting as both order ma=\r\nnagement and transaction orchestrator.</p>\r\n<h2 local-id=3D\"3df2aadc-e74c-4f7f-a608-5834d2c96407\" id=3D\"PaymentsEvoluti=\r\non-Plutus\">Plutus</h2>\r\n<ol start=3D\"1\" local-id=3D\"0bff4ba3-d393-40a4-8dfc-a545bd8d07fb\">\r\n<li local-id=3D\"4dfeae7a-8eb2-4340-8d05-f4960375892a\">\r\n<p local-id=3D\"f1e914fc-17db-4bca-ad99-7c6652d16af7\"><code>Loading</code> a=\r\nnd <code>Fulfilment</code> are the key flows that plutus supports</p></li>\r\n<li local-id=3D\"60c2f563-7135-4ebe-84af-470c01371a2f\">\r\n<p local-id=3D\"9dff97a9-9e0a-43e5-bff9-6d469a32876d\"><code>Plutus</code> ha=\r\nd integration with Juspay=E2=80=99s express checkout for loading</p>\r\n<ol start=3D\"1\" local-id=3D\"140fcd7c-1d5f-4632-9fd8-132872254756\">\r\n<li local-id=3D\"323429c8-88ec-444f-a72e-704f5e2263de\">\r\n<p local-id=3D\"968c9199-3b1b-43cb-8722-3372f9d397e9\">Express checkout conne=\r\ncts with multiple partners. Eg. Rzp, PayU, Cashfree, etc</p></li>\r\n<li local-id=3D\"62e600a2-b911-4596-8565-7eb96b4c7520\">\r\n<p local-id=3D\"dd721e84-48fb-4d85-8c86-e503c7cfc77f\">Morpheus connects with=\r\n multiple partners. RBL, YBL</p></li>\r\n</ol></li>\r\n<li local-id=3D\"027fe507-31e2-4ac0-b5c4-816d3d483173\">\r\n<p local-id=3D\"49bff10e-2452-4bcf-a549-5a4147bea927\"><code>Plutus</code> ha=\r\nd integration with Juspay=E2=80=99s Morpheus for fulfilment</p></li>\r\n<li local-id=3D\"a25f8510-8590-442f-ab35-f73ee376432e\">\r\n<p local-id=3D\"26168a96-2115-4d66-9bc0-809ff2b9fd98\">After <code>darwin</co=\r\nde>(in house replacement of express checkout) and <code>genie</code>(in hou=\r\nse replacement of morpheus) got introduced, <code>plutus</code> would call =\r\ndarwin for loading first, and then genie for fulfilment.</p></li>\r\n<li local-id=3D\"e1a4a549-ca54-404c-9255-27407ca47a9a\">\r\n<p local-id=3D\"a837b9ee-04b1-4e7d-98ce-edea682b7475\">After both loading, an=\r\nd fulfilment are success, plutus gives success to lob.</p></li>\r\n<li local-id=3D\"ca76e9bc-f3bc-4406-8f72-6c3c597891b4\">\r\n<p local-id=3D\"deddb315-f682-46ae-bd31-2d3ab48759ad\">There were three types=\r\n of orders:</p>\r\n<ol start=3D\"1\" local-id=3D\"c19dbb13-d33b-4216-9792-2b299182aa3e\">\r\n<li local-id=3D\"ce4ab1db-20de-4406-b3d4-7a4897b7cc5b\">\r\n<p local-id=3D\"885bcf92-f937-44b6-810e-275fcfeb0e6f\">pay/loading only</p></=\r\nli>\r\n<li local-id=3D\"5abf0378-a938-45b6-a30c-f5182eacb5f1\">\r\n<p local-id=3D\"1299ba67-8d0e-49d6-bcef-a25865a1ff43\">loading &amp; fulfilme=\r\nnt: ccbp, bbps</p></li>\r\n<li local-id=3D\"5f5ab6d1-61a5-4435-bb20-c3c4c291d921\">\r\n<p local-id=3D\"f847df62-a018-485c-8380-f09733045ec8\">fulfilment only: cashb=\r\nacks to credit card</p></li>\r\n</ol></li>\r\n<li local-id=3D\"24b8d837-6e09-4fb5-a340-a8a83b11df6d\">\r\n<p local-id=3D\"53818137-22bb-4356-b1f3-2db6fdc989b9\">Plutus was multi-tenan=\r\nt.</p></li>\r\n<li local-id=3D\"09962095-0911-4583-b786-75537e250acb\">\r\n<p local-id=3D\"05bbf727-5121-435d-afc6-6340d5786316\">When fulfilment fails,=\r\n plutus would trigger the auto-refund of loaded amount.</p></li>\r\n</ol>\r\n<h2 local-id=3D\"08871f51-a3aa-477d-b6b2-962adaab1b4e\" id=3D\"PaymentsEvoluti=\r\non-Overall\">Overall</h2>\r\n<p local-id=3D\"7815f73f-f9b2-4016-8720-213a349f0421\">Payments has total of =\r\n4 steps:</p>\r\n<ol start=3D\"1\" local-id=3D\"353ee5ac-8ab1-48e1-9f3c-380cd55f469e\">\r\n<li local-id=3D\"cda50cb0-5813-4098-9289-38b481efb042\">\r\n<p local-id=3D\"0c7ad17f-d2e5-4922-b8da-c818e6e01d1a\">Merchant onboarding</p=\r\n></li>\r\n<li local-id=3D\"f5d6d865-3f4b-4486-bf8c-cbd034390fd6\">\r\n<p local-id=3D\"0c0ce13b-0156-4145-b3a1-4d8196ad0a1b\">Payment readiness</p><=\r\n/li>\r\n<li local-id=3D\"58be5d95-7252-464c-85eb-c982ddd0324f\">\r\n<p local-id=3D\"3782406a-ba05-4019-813d-2ccecd78ba81\">Payment processing</p>=\r\n</li>\r\n<li local-id=3D\"5dee8387-33fe-4df4-b69b-1960983a7e24\">\r\n<p local-id=3D\"ea8ad4c5-3b00-4afd-9942-c71fb8e4413c\">Post-payment: refund, =\r\nchargeback etc</p></li>\r\n</ol>\r\n<h1 local-id=3D\"5104f7a3-3019-4b85-83b4-c0e13c7469e6\" id=3D\"PaymentsEvoluti=\r\non-Paymentprocessing\">Payment processing</h1>\r\n<p local-id=3D\"89a1cfc9-4ae3-49bc-a152-f2c38b5db6ce\">There are two major co=\r\nmponents of payments processing:</p>\r\n<ol start=3D\"1\" local-id=3D\"10fa7dfe-8008-4902-8a2b-511af5180f08\">\r\n<li local-id=3D\"05d94061-b21d-403c-9cd9-4445820a5e1c\">\r\n<p local-id=3D\"c7cb34d5-cdf9-46b3-b532-9765ce0b8f19\">Instrument</p>\r\n<ol start=3D\"1\" local-id=3D\"3ac182db-b80b-4a26-91e1-b7ecebb1081b\">\r\n<li local-id=3D\"472a5826-5f21-4f1f-a936-615a78695222\">\r\n<p local-id=3D\"03193b74-06d8-4ec8-82f3-7303a99e2db0\">Storage: at user level=\r\n instruments</p></li>\r\n<li local-id=3D\"a91b6c7b-ea0b-4cd5-9bb7-1e25cdf4c8c3\">\r\n<p local-id=3D\"2fd0055c-8f57-4a0e-879f-e3716e3523a5\">Discovery: more of che=\r\nckout</p></li>\r\n<li local-id=3D\"c33f207c-16bd-46f0-bcc2-4033d39705cd\">\r\n<p local-id=3D\"cb938534-6533-405c-b72c-1454099a5c42\">Card tokenisation: thi=\r\ns is limited to card tokens only. If tomorrow other instruments needs to be=\r\n tokenised, things haven=E2=80=99t been thought through as of now. Liea is =\r\npositioned more as a card tokenisation</p></li>\r\n</ol></li>\r\n<li local-id=3D\"c3d5f40c-9c81-4193-8ca8-fed3a8235045\">\r\n<p local-id=3D\"f7294f27-fa28-49d0-96fe-c8728131a8b9\">Payments</p>\r\n<ol start=3D\"1\" local-id=3D\"4a1a9bde-ffc0-44d4-9f87-b19ce422044e\">\r\n<li local-id=3D\"31883b48-fe5d-41cb-8c6a-9646a8da1574\">\r\n<p local-id=3D\"325a3248-507f-49ca-9390-9fbe80a2011e\">Loading</p>\r\n<ol start=3D\"1\" local-id=3D\"302b5c31-6e05-4c22-b24c-97a3b3886f07\">\r\n<li local-id=3D\"3a838f5f-b6a0-44f1-8e99-744c68fb9fb4\">\r\n<p local-id=3D\"0cf1b7ca-de6c-4e91-9bbb-4c86e16fcea1\">Everything started as =\r\nloading via express checkout.</p></li>\r\n<li local-id=3D\"60e05e02-72c8-41b3-8b45-ac740c14ae2e\">\r\n<p local-id=3D\"d8228c80-0b9d-4eec-a503-f234a991602b\">Juspay had two configu=\r\nration models:</p>\r\n<ol start=3D\"1\" local-id=3D\"cbd604ea-245b-44a5-9715-d29da98852a7\">\r\n<li local-id=3D\"1b27b127-ffd2-4678-a996-b7d997a018fa\">\r\n<p local-id=3D\"07bc71f3-48be-4fdb-8354-9f89b766d786\">Configure at juspay=E2=\r\n=80=99s leg to select provider</p></li>\r\n<li local-id=3D\"5087a5e9-c247-468a-b59b-c547e48facbe\">\r\n<p local-id=3D\"bdf44f56-cf6b-42e3-83b3-e93c8ad2abe7\">Resolve the provider a=\r\nt client end, and share the provider in the request at transaction level.</=\r\np></li>\r\n</ol></li>\r\n<li local-id=3D\"90e3b949-034d-4c62-86b2-19e64422d5c8\">\r\n<p local-id=3D\"ee7467c4-df8a-450f-8bf3-68313df721b8\">Initially we started w=\r\nith first model, and then when we matured a little, we moved to second conf=\r\niguration model.</p></li>\r\n</ol></li>\r\n<li local-id=3D\"1dc0367e-ec57-4bf2-b215-262d17e718c5\">\r\n<p local-id=3D\"550277ba-e2ac-4000-b193-7bfc460c481a\">Fulfilment</p>\r\n<ol start=3D\"1\" local-id=3D\"af62b3f3-2730-4e42-a5e9-94d88e10869b\">\r\n<li local-id=3D\"8d676a60-5d32-4b24-94f6-922382ff5df1\">\r\n<p local-id=3D\"95f253d5-b62e-4f37-b68d-fd3cb017bc07\">Here things started as=\r\n Juspay=E2=80=99s Morpheus.</p></li>\r\n</ol></li>\r\n</ol></li>\r\n</ol>\r\n<h2 local-id=3D\"ef9b7e05-d136-47d0-b433-c2d7cbd92dd4\" id=3D\"PaymentsEvoluti=\r\non-Genie\">Genie</h2>\r\n<p local-id=3D\"97497e3e-7568-4710-9b35-6d6d1b6ec169\">The major problems we =\r\nface are more on fulfilment. We=E2=80=99re unable to fulfil promises, and e=\r\nnd up refunding etc. So we planned of moving fulfilment to in-house first. =\r\nAs a result genie was built. Genie is multi-tenant.</p>\r\n<ol start=3D\"1\" local-id=3D\"01632aca-09c0-42ea-9aed-69615f04301c\">\r\n<li local-id=3D\"91667d32-1e88-4223-8eac-a5eb82ee24c9\">\r\n<p local-id=3D\"480c9a54-ea24-4323-af7d-bb6795aaab40\">Genie has different pa=\r\nyout partners/provider, supporting multiple rails/channel.</p></li>\r\n<li local-id=3D\"9dcbe0dd-ed96-430c-8af5-ea21b94fe721\">\r\n<p local-id=3D\"0f640d56-52df-4eb1-92a6-df546e62f614\">Genie became the repla=\r\ncement of Morpheus.</p></li>\r\n<li local-id=3D\"96a0937a-c4a2-4dba-b783-23d9ce2cbcf3\">\r\n<p local-id=3D\"488ceb9e-17ef-4bfa-a9a7-ff18750ac274\">As part of migration <=\r\ncode>plutus</code> started calling <code>genie</code>, and <code>genie</cod=\r\ne> was calling <code>Morpheus</code>during migration.</p></li>\r\n<li local-id=3D\"fc1fe181-a1cd-4657-a0e3-f63d7da383d8\">\r\n<p local-id=3D\"7da56865-5430-4442-8a08-4c392b2356da\">Later on, it started i=\r\nntegrating with different partners.</p></li>\r\n<li local-id=3D\"8dd0cfd0-a7f7-4792-b253-3547dd874250\">\r\n<p local-id=3D\"cd20e0ce-2caa-47d7-ba91-ba4487bf738d\">Currently genie suppor=\r\nts 12-13 payout partners.</p></li>\r\n<li local-id=3D\"9ce7ee81-ab72-4b59-b58e-492237432ba1\">\r\n<p local-id=3D\"2230c138-b0e5-4df5-aa74-62165d786fcc\">Morpheus is no longer =\r\nexisting in our setup now.</p></li>\r\n<li local-id=3D\"f6d55dc6-ad67-43cc-82dd-c97e7f188606\">\r\n<p local-id=3D\"691bfb5a-8081-49b0-84d3-f9e312dabe94\">Genie is a dpspl offer=\r\ning for payout, and it is used by multiple tenants, where PA is one of thos=\r\ne tenants for payouts.</p></li>\r\n<li local-id=3D\"df40b75b-3cb2-4724-a8cc-611201e2745d\">\r\n<p local-id=3D\"f8793c45-260b-43bb-a4de-50e997e0aa44\">Genie is the only comp=\r\nonent who is involved in fund transfer</p></li>\r\n<li local-id=3D\"66a298ea-ca45-48e3-9bee-47f827fbf96f\">\r\n<p local-id=3D\"0bca6b6c-9362-42bd-bd32-ce2439765a0f\">Genie does not have ba=\r\nlance management of the banks.</p></li>\r\n<li local-id=3D\"6b3d92d3-04fd-4c1e-a03a-7636b72a4319\">\r\n<p local-id=3D\"483b9eb5-a111-4ab1-a6b1-84260785737b\">Genie expects that you=\r\n have a bank account, and I=E2=80=99m one of the parties who is authorized =\r\nto do the transfer.</p></li>\r\n</ol>\r\n<h2 local-id=3D\"62aef1a5-7bd3-439b-b559-85fdd1e7147a\" id=3D\"PaymentsEvoluti=\r\non-Darwin\">Darwin</h2>\r\n<p local-id=3D\"2846d7c7-d449-496a-9217-c7779a5fb22a\">Darwin is similar to g=\r\nenie for loading part. Darwin integrates with different providers, who it w=\r\nill integrate to get the money. Darwin is multi-tenant.</p>\r\n<ol start=3D\"1\" local-id=3D\"079d3002-c06f-4edb-80fb-b9cd60235cc4\">\r\n<li local-id=3D\"dac9db5e-9762-4970-aaa4-92d42c5d5d7d\">\r\n<p local-id=3D\"a03cffbd-91f6-469d-9d7e-26f4c3afd8df\">Provider=E2=80=99s def=\r\ninition is more of who has similar API structure/TSP.</p></li>\r\n<li local-id=3D\"4075faf0-d299-4dc8-a9e1-d2792a0c32b3\">\r\n<p local-id=3D\"850768cc-4948-4168-bc35-4b30320b53b4\">The same provider like=\r\n cybersource integration -</p>\r\n<ol start=3D\"1\" local-id=3D\"908402d6-f753-47ea-bd97-a7cb4cc03820\">\r\n<li local-id=3D\"b8da2130-d026-4099-b46a-bf785eb0ecd3\">\r\n<p local-id=3D\"9d6670c4-838f-4e07-84f0-4d717525948a\">Partner Axis can give =\r\nthe money using one credentials</p></li>\r\n<li local-id=3D\"ac76cbce-3d99-4807-a358-4fcb0a348ac7\">\r\n<p local-id=3D\"6536e96e-242d-4cb1-93ca-3a3a486313dc\">Partner YBL can give t=\r\nhe money using another credentials</p></li>\r\n</ol></li>\r\n<li local-id=3D\"0bfd16ec-00d3-4d67-bf91-01175242b79c\">\r\n<p local-id=3D\"edebf9ad-5e0b-420e-aa96-8b18451fb21e\">Similar to genie model=\r\n, we have Express Checkout also as another provider.</p></li>\r\n<li local-id=3D\"76ea568b-c28c-4b2e-8c68-1054c4d3a2b8\">\r\n<p local-id=3D\"afc87d0c-408e-411c-9c40-a04f48003f93\">Express checkout still=\r\n exist.</p></li>\r\n<li local-id=3D\"89ce4362-f58a-4828-b1a2-d87bec9356c5\">\r\n<p local-id=3D\"0f4cc36a-42a4-4ad4-b167-e3c4df46ba96\">Every time adding a ne=\r\nw provider needs a dev effort. So when the provider is small, and not much =\r\nROI, we use express checkout to simplify the onboarding.</p></li>\r\n</ol>\r\n<p local-id=3D\"c8b6d8b6-5740-4210-a39e-79a5970a6ecc\">Darwin has multiple Pa=\r\nyment Methods</p>\r\n<ol start=3D\"1\" local-id=3D\"19c1f69f-8dc3-4dcb-86a4-ad5cfaaf3e27\">\r\n<li local-id=3D\"59a24105-987a-463f-84a4-09e69a44b76b\">\r\n<p local-id=3D\"5ebb2d87-5acc-4aba-85fd-8fc2e5d96cb3\">C-UPI started growing =\r\nvery fast, and we had 60% CCBP started coming in from C-UPI.</p></li>\r\n<li local-id=3D\"0ef7c400-f706-4ad7-ab7b-3e20c074ed5a\">\r\n<p local-id=3D\"6e62b291-96dc-4c25-9b29-435053c4c866\">Darwin has different p=\r\nayment methods like CC, Net-Banking, DC, C-UPI, UPI(other apps).</p>\r\n<ol start=3D\"1\" local-id=3D\"b203cbbf-190b-4a06-b066-cf15e3592094\">\r\n<li local-id=3D\"182e4720-b849-4f79-8150-b90c90a17ebc\">\r\n<p local-id=3D\"08f852b0-9632-49ad-b3d5-faf70f56108a\">It added CUPI as a sep=\r\narate method, and interface for transacting is different, than normal UPI</=\r\np></li>\r\n<li local-id=3D\"dbc8158a-2bdf-43ea-bb87-821ab2a4137a\">\r\n<p local-id=3D\"792847c8-a7a4-42a0-94b1-2ea363d34bc7\">The reason to take thi=\r\ns decision was, so that experience, flows, and interfaces for CRED UPI vs o=\r\nther UPI apps.</p></li>\r\n</ol></li>\r\n</ol>\r\n<h3 local-id=3D\"1ad120a7-9182-4462-97ed-1d26efe6d52c\" id=3D\"PaymentsEvoluti=\r\non-MerchantPaymentOrchestrator\">Merchant Payment Orchestrator</h3>\r\n<p local-id=3D\"dc5c1970-8ce8-4a82-8e09-0007bf3fc566\">Given we did not want =\r\nto corrupt the darwin contracts, we introduced MPO as the wrapper layer on =\r\nDTPL side that acts makes it easy for CRED to integrate.</p>\r\n<p local-id=3D\"2d06402a-be94-4003-9bd2-b91102ff4042\">Majorly checkout, and =\r\nsome lobs who do not have checkout integrates with MPO. Currently, checkout=\r\n, cash, and wealth has integration with MPO.</p>\r\n<p local-id=3D\"4fed6bdd-d48c-46e2-86ba-0e24a68bf593\">Darwin is mostly backe=\r\nd by the MPO, direct use is rare. Limited to use cases like CRED QR etc.</p=\r\n>\r\n<h3 local-id=3D\"7d7f029c-f37f-4d69-a045-87fbd6446a6a\" id=3D\"PaymentsEvoluti=\r\non-ComponentX\">ComponentX</h3>\r\n<ul local-id=3D\"3864678e-c62d-4d91-9196-46f9b6d4f2af\">\r\n<li local-id=3D\"39bfb931-d0d6-444f-beb3-0eb950d0c273\">\r\n<p local-id=3D\"054e9e2a-4572-442c-99ff-bf1f6c5862de\">ComponentX is a monoli=\r\nth of SDKs.</p></li>\r\n<li local-id=3D\"dfaf0b3f-feb7-42f9-89c8-ce8953f7184d\">\r\n<p local-id=3D\"856e42fb-8abd-4802-a03c-576f564d78c1\">It decides when to inv=\r\noke which SDK, and orchestrates the flow to &amp; from SDKs.</p></li>\r\n<li local-id=3D\"bb50c0df-966b-45e5-a00d-aba8a707844c\">\r\n<p local-id=3D\"b452e440-ad56-4782-b748-55738d20462f\">It helps resolve diffe=\r\nrent UPI SDK flows.</p></li>\r\n</ul>\r\n<h1 local-id=3D\"b4e0f081-43f6-4a1e-8414-2396b6a31eb2\" id=3D\"PaymentsEvoluti=\r\non-BirthofPA\">Birth of PA</h1>\r\n<p local-id=3D\"cfa7c003-2dd6-44e5-b567-c787dd455143\">We had 30K crore of mo=\r\nnthly transacting amounts. At the time, we had nodal account to enable this=\r\n transfers.</p>\r\n<p local-id=3D\"4be64293-7f65-44f0-bd15-ae9553ed0435\">For any fund transfers=\r\n, where you don=E2=80=99t own the money, nodal account was used.</p>\r\n<p local-id=3D\"887a0546-e53d-478d-87ce-da0a1a47d14c\">From 2020 PA guideline=\r\ns, RBI barred nodal accounts. And recommends to use the escrow account.</p>\r\n<p local-id=3D\"ab7b2716-72ff-4b4f-b9f9-1ab55535bc79\">In escrow, most of the=\r\n money is not you own, only some part is what you own. Basis nature of your=\r\n business, only income part, for example MDR, fees, etc, can be part of esc=\r\nrow, else most of the money is something that is owned by your partners/cus=\r\ntomers</p>\r\n<p local-id=3D\"2b6852bd-e9f8-419f-9c7f-d7e883c3b189\">We can use the escrow =\r\naccount for tax payments of PA, but people prefer not to. They transfer mon=\r\ney to their current account for realising the income, and then do these tax=\r\n payments etc from current account itself.</p>\r\n<p local-id=3D\"babcab30-b7fb-46bd-a9fc-68e7d754290d\">Given, we were large b=\r\nusiness, and there was a regulatory risk in the absence, we applied for PA =\r\nlicense. We had two options:</p>\r\n<ol start=3D\"1\" local-id=3D\"62a2c887-221e-409c-94ec-447859201f58\">\r\n<li local-id=3D\"179c86b3-5d24-4a41-9c7f-525892d1ccc5\">\r\n<p local-id=3D\"5555addd-8ac5-4e27-bcc3-bacb7e6eaed4\">We apply as new entity=\r\n</p>\r\n<ol start=3D\"1\" local-id=3D\"88e29a26-6840-40ed-8c52-c7e47b4e68b1\">\r\n<li local-id=3D\"179c86b3-5d24-4a41-9c7f-525892d1ccc5\">\r\n<p local-id=3D\"c10a756d-3153-4565-81b2-e836b011788c\">If we apply as a new e=\r\nntity, RBI vets the whole company, processes, business etc before giving th=\r\ne license, and it brings more scrutiny.</p></li>\r\n</ol></li>\r\n<li local-id=3D\"0cfcb5fc-4dcc-4430-841a-a6d7d7a3dafe\">\r\n<p local-id=3D\"c728ed6c-168c-4199-bf24-9d686e0b2309\">We apply as existing c=\r\nompany.</p>\r\n<ol start=3D\"1\" local-id=3D\"bc2105f9-8d28-4389-ad3d-11606f172ad1\">\r\n<li local-id=3D\"4073d56f-0b81-4380-8ecb-38d421567812\">\r\n<p local-id=3D\"ddc06cce-e0fb-4c52-9d12-8cec8c26ba5e\">Here some business is =\r\nalready running, hence applying as existing company who has the PA business=\r\n is comparatively easier.</p></li>\r\n<li local-id=3D\"e6699c0f-e906-40ca-82e1-c0864470ed08\">\r\n<p local-id=3D\"769d16a3-8a7e-4600-8470-2cba905a86a7\">Hence we chose this pa=\r\nth, because we had the running business at the time.</p></li>\r\n<li local-id=3D\"d8bca08b-257b-4976-b0c7-f670b519f4a7\">\r\n<p local-id=3D\"2bd1cd53-34d6-4d08-93b3-566b8e89d03f\">We had some 30 nodal a=\r\nccounts at the time. And shared ccbp is the fund aggregator use case. This =\r\ngot signed off, that yes it is an existing entity.</p></li>\r\n</ol></li>\r\n</ol>\r\n<p local-id=3D\"75dcaf81-18db-4afd-9d69-31f8f1bd4d88\">We could have chosen t=\r\no make either DTPL as a PA entity, or create a new entity. We chose the pat=\r\nh of creating new entity DPSPL, to avoid customer facing company having any=\r\n regulatory scrutiny.</p>\r\n<p local-id=3D\"2a0f62bc-ee19-4324-97dd-e441fecc4dbc\">At the time, all the e=\r\nxisting service of plutus, darwin, genie etc were part of DTPL. Darwin, Gen=\r\nie, and card tokenisation/leia were recognised as PA components, we moved t=\r\nhese to DPSPL.</p>\r\n<p local-id=3D\"7721cced-a31e-4ec5-a7a8-b24ce2de54e8\">Plutus continued to ca=\r\nll darwin/genie etc in new dpspl environment. And bill payments were workin=\r\ng in this new setup. Other systems/components were built later on for other=\r\n merchants later on.</p>\r\n<h2 local-id=3D\"c6f37a46-0d7b-4df3-ae59-b7cf324a9401\" id=3D\"PaymentsEvoluti=\r\non-Narad\">Narad</h2>\r\n<ol start=3D\"1\" local-id=3D\"6d881051-98f6-4176-a261-e18969d71521\">\r\n<li local-id=3D\"398ca872-0cfa-4103-9f3c-ef61f238f58c\">\r\n<p local-id=3D\"9223332b-8985-4ade-88b7-b5239e176fb9\">near real time routing=\r\n logic</p></li>\r\n<li local-id=3D\"beeb7875-36fd-4c11-ab11-4d6c50975d1e\">\r\n<p local-id=3D\"7a836dc3-6b29-4415-a970-162295eddfb9\">it integrates with dow=\r\nntime detection models, and works on success rates etc</p></li>\r\n<li local-id=3D\"4581f095-8447-47b0-a138-feae62951fe7\">\r\n<p local-id=3D\"8a1635f7-105a-41bc-976f-a17c3e957218\">it routes to another p=\r\nrovider within 3 minutes when something starts failing</p></li>\r\n</ol>\r\n<h2 local-id=3D\"64c361f4-3ab9-4e34-8466-0da46daf075e\" id=3D\"PaymentsEvoluti=\r\non-Mandates\">Mandates</h2>\r\n<ul local-id=3D\"8a039ba6-e083-495b-918f-37f86a370186\">\r\n<li local-id=3D\"fd89cfe5-2287-4c51-90e4-f9ebe1e9c706\">\r\n<p local-id=3D\"26e7a37e-2a8d-4bb7-886a-6877f4e1efcf\">Originally only standa=\r\nrd payments were supported, for supporting mandates, mandate service is bui=\r\nlt.</p></li>\r\n<li local-id=3D\"2190a2bb-725f-4822-9325-d30318e6b399\">\r\n<p local-id=3D\"634d07c8-17a9-4228-8fae-38de34cfe4f2\">The nuances among darw=\r\nin and mandate service has very thin boundary, so externally its the same.<=\r\n/p></li>\r\n</ul>\r\n<h1 local-id=3D\"a2a2a60b-d092-4cae-a496-2aaa6e5c4cd3\" id=3D\"PaymentsEvoluti=\r\non-MerchantsasEntityinPA\">Merchants as Entity in PA</h1>\r\n<p local-id=3D\"91b87658-d0fe-4111-9da9-f5d4e401968c\">We have a merchant ser=\r\nvice for merchant onboarding/management, and we use jocata for AML flows.</=\r\np>\r\n<ul local-id=3D\"a117fe75-6123-4b55-acf9-b2587d8a0a3f\">\r\n<li local-id=3D\"73103de3-5548-47c9-b188-b83e52ee2bc4\">\r\n<p local-id=3D\"1b22b298-60e5-499e-b074-d37719e395b4\">Dunzo/Swiggy was one o=\r\nf the first merchants. Where we created the CRED Pay, and this dunzo/swiggy=\r\n became other merchants, other than DTPL(being used for bill payments).</p>=\r\n</li>\r\n<li local-id=3D\"03bfd6a3-1389-4b6b-a73c-8d93966c5f1e\">\r\n<p local-id=3D\"36facffd-5f5e-4396-8517-b3244c79695b\">Here, user flows, such=\r\n as instrument discovery, reward/offer, etc becomes key. This is solved usi=\r\nng heimdall from DTPL side, and darwin was helping solve the same on paymen=\r\nts side.</p></li>\r\n<li local-id=3D\"6763b626-c2b7-41ec-8696-3cb6d7dd3b56\">\r\n<p local-id=3D\"3e05e53a-cc05-46a1-b9a8-dd741838956d\">When the money hits th=\r\ne escrow account, someone needs to aggregate the amount per day, to compute=\r\n MDR, and then transfer the remaining to merchant. To support this, there w=\r\nas a configurable script was created for a merchant called SCAR. Originally=\r\n scar used heimdal and genie to identify the transactions to aggregate. Lat=\r\ner on settlement engine was created to replace this, and do it properly in =\r\ndpspl.</p></li>\r\n<li local-id=3D\"5b802b48-89be-42a9-bdd7-2ad9f4bcc239\">\r\n<p local-id=3D\"445b2f9d-850e-42ef-87e0-0af86e7ad091\">Settlement engine has =\r\nan accounting, that does the aggregation, computes fees using a fee rule en=\r\ngine using service called tyrion, and computes the amount to settle.</p></l=\r\ni>\r\n<li local-id=3D\"47a5cb5e-a2ef-42f9-ae4b-0481ec058df6\">\r\n<p local-id=3D\"834a0cd0-7f4d-4ebd-9156-985ab03d9414\">And finally genie is u=\r\nsed to do the settlement. Before settlement engine, scar also used genie on=\r\nly for the fund transfer.</p></li>\r\n<li local-id=3D\"10761f89-7120-49c9-b0b8-49dc3fffe718\">\r\n<p local-id=3D\"51b3cf80-0d7e-46de-8820-106cb404d4c3\">MCC is not standardise=\r\nd in industry, we have used npci mcc definition for our own mccs.</p></li>\r\n<li local-id=3D\"99ac1a7a-f2a4-4eb1-91ee-7aa6564809b4\">\r\n<p local-id=3D\"59997dc0-6f28-4ba0-a862-01e821e6d6bc\">As part of payment rea=\r\ndiness, as part of merchant onboarding, the configuration of MCC is created=\r\n for the supported payment instruments.</p></li>\r\n</ul>\r\n<h2 local-id=3D\"2583de3c-090f-44b2-a6eb-0ebf1a94b498\" id=3D\"PaymentsEvoluti=\r\non-LCM(LoadingCapabilityManager)\">LCM (Loading Capability Manager)</h2>\r\n<ul local-id=3D\"8bb73553-2512-4288-acd4-037a71c7dee2\">\r\n<li local-id=3D\"c34298cd-2d71-4b66-b3b6-315ef5102c41\">\r\n<p local-id=3D\"0ecb0c92-5989-43f7-866c-75791dbc79e2\">as part of merchant on=\r\nboarding, given mcc level type of payment instruments are configured, this =\r\nhelps validate which all instruments are allowed for a transaction/merchant=\r\n.</p></li>\r\n<li local-id=3D\"d792c654-f753-4e7f-80f0-409bacbddf14\">\r\n<p local-id=3D\"9f657d9e-515d-433a-9b62-0954ee1ab73d\">in the absence of LCM,=\r\n darwin was having routing logic for each merchant. And as part of this, th=\r\ne routing did not exist for unsupported instruments, and PA would fail the =\r\ntransaction if let say credit card is used for paying a loan.</p></li>\r\n<li local-id=3D\"99a98d1b-5c01-48ce-9632-8e85af1aa2fa\">\r\n<p local-id=3D\"49fcc8ce-77c9-4225-b962-ff3ccc3b2fe2\">for every new use case=\r\n we create a new terminal, and configure the same in lcm.</p></li>\r\n</ul>\r\n    </div>\r\n</body>\r\n</html>\r\n------=_Part_0_693573571.1767098193977--\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r100   120    0   120    0     0    322      0 --:--:-- --:--:-- --:--:--   322","stderr":"","interrupted":false,"isImage":false}}
{"parentUuid":"f5dba820-7898-48c5-ba13-9ad16446a851","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","message":{"model":"claude-opus-4-5-20251101","id":"msg_bdrk_01Sc4hCJv44QYCYXUtGFPQEW","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"I now have the full content of the document. It's an HTML export from Confluence about \"Payments Evolution\". Let me extract the key content and rewrite it in a cleaner, more polished format as a markdown file.\n\nThe document covers:\n1. Background - Introduction to Plutus\n2. Plutus - The original transaction processing system\n3. Overall - The 4 steps of payments\n4. Payment Processing - Instruments and Payments (Loading, Fulfilment)\n5. Genie - In-house fulfilment system\n6. Darwin - In-house loading system\n7. MPO (Merchant Payment Orchestrator)\n8. ComponentX\n9. Birth of PA - Regulatory background for PA license\n10. Narad - Routing logic\n11. Mandates\n12. Merchants as Entity in PA\n13. LCM (Loading Capability Manager)\n\nLet me create a refined, well-structured markdown document that preserves all the details but improves the language and readability.","signature":"EvQHCkgICxABGAIqQFlJZX2Iey7y/z9i+xNtwVLUrAnAGBnIeEbhSwGpJYAo+w0GgTH3iHVMaw9vT2vrqUDJ9VZRwAaYxTANSpk0D9oSDAB3iwctNiGJLfTjERoMGhjk6Fr2CITSVTPxIjAi/AUeRBaJl2V/nN0s9IJrIeKsLXU9+WMGIuCWePUMhlD21/go2Bri8BxqrMJqJfMq2QYdw5d2BcSllzrb6KBL/OXuB2xiYhDAFTXtto7hOvYg+wMKNgzJxYoZ2366cH2BHtTJHi4Jiply3ij4NnOKWeyYsaTTHvZnodb4rgkWmRs6oARj+0xKdYsAFxVp+WqYysuH1+etolf9/7wDe/Sn8TUCxPEYOy78HJyBsk4DEUmcvvgGxGGbYHEiKx64i8OcdI7iRGZtpm8QlpDrYVSQkyVkTfT11H8jURH+lSi4FbIpbRh7KJnlDdQIrhyJ1yVciYVMJH7Eezj2nqDzpYxqcilNxYwmYSRaZ+QALbdpIMJwZRZXJNbGFQL2KJqNUXDAtTnOH9z0gkW5oAhYHpnXDuBdSALa9v+kVaOoJ8XSXL0Tm+cPSmn41V12eriFzABqh7Skm1W5PmqMm27qaNUM8lGTVIgK+LToicG0hRa/HHQ6EQ9OuOLDutgbhi7jdIRY+JjE9IYUyT/r3ZfO7GnvW26W0Y+FAPLehQNKH92nka/02L5pxxsE4lcLnM73bNyXT3R9lOypSiDvdLmIZ+4sflt7W9PpSGbFNHG6x+yKEwN0XL1rOSii9Lddqpj4A5tYsgGFGqM+XyBlQqJh2sOTP/zRFAPA3rVUHDQPBovclG2KPPkU+4YoXA47TpaYGnMxnbvPRpe4r90Nj+sQJNRCK18uA+Cdg8jyciBS4z5AzOdNwypiGvNiZbrVlw9rbCA31TZxzyzkTWw4Q6gUJknZf37Fl/JX+JsJk/qK+Pp2CYPZ1Mq36DSNvslXpVsF13HqMkPztvKnk9LjPocOlsT4XwpmBoyqgYrIaqBV7VR3xNPPxTB3HDfxGL/pgt/qosgi2ECdeRzzsfcel6SdTpzYsIslR2T5u4Lj6iK+mMifZUYs2/pz8v1mhFUDoImqY10Q3sybpx8lYbKfy2N3vt+QzUL4Zu9q/33a9BriP6ZOUVtxHcg6hTsMSD3FUGuFb+3PNWs08nYhC+eRwjJjO8OYRp0J4xwDbo8IxMv/UxvjCU0s+b/yFouebxPZLcgo8zHnpn3ahBZDbef6JfNHaZG28J67BYWlFay4c2oxgBCtWlK36IBKVmJGcRZa4rFNA89+TBB7U1Aqjgm6idcO3UbdgNl7rqvduXOXf1UseyEV2XoWvCihq95w4guKPRgB"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":7,"cache_creation_input_tokens":12879,"cache_read_input_tokens":48042,"cache_creation":{"ephemeral_5m_input_tokens":12879,"ephemeral_1h_input_tokens":0},"output_tokens":1}},"type":"assistant","uuid":"7f6563ea-8bd0-4a88-8e90-d6bc3cee1d47","timestamp":"2025-12-31T06:18:23.895Z"}
{"parentUuid":"7f6563ea-8bd0-4a88-8e90-d6bc3cee1d47","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","message":{"model":"claude-opus-4-5-20251101","id":"msg_bdrk_01Sc4hCJv44QYCYXUtGFPQEW","type":"message","role":"assistant","content":[{"type":"text","text":"I've extracted the content. Now let me create a refined markdown document with improved language while preserving all the details."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":7,"cache_creation_input_tokens":12879,"cache_read_input_tokens":48042,"cache_creation":{"ephemeral_5m_input_tokens":12879,"ephemeral_1h_input_tokens":0},"output_tokens":1}},"type":"assistant","uuid":"606aaba2-7030-4f19-a415-3b6af6a2e182","timestamp":"2025-12-31T06:18:24.394Z"}
{"parentUuid":"606aaba2-7030-4f19-a415-3b6af6a2e182","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","type":"user","message":{"role":"user","content":[{"type":"text","text":"[Request interrupted by user]"}]},"uuid":"bdf1f52f-ba29-4a2f-938f-a71ed324f9ed","timestamp":"2025-12-31T06:18:48.950Z"}
{"type":"file-history-snapshot","messageId":"c52a9b9c-785f-4d19-ac63-fa7d4c500783","snapshot":{"messageId":"c52a9b9c-785f-4d19-ac63-fa7d4c500783","trackedFileBackups":{},"timestamp":"2025-12-31T06:19:07.308Z"},"isSnapshotUpdate":false}
{"parentUuid":"bdf1f52f-ba29-4a2f-938f-a71ed324f9ed","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","type":"user","message":{"role":"user","content":"https://dreamplug.atlassian.net/wiki/spaces/~132594828/pages/5567807498/Payments+Evolution you can use this document as a source instead of the binary doc."},"uuid":"c52a9b9c-785f-4d19-ac63-fa7d4c500783","timestamp":"2025-12-31T06:19:07.298Z","thinkingMetadata":{"level":"high","disabled":false,"triggers":[]},"todos":[]}
{"parentUuid":"c52a9b9c-785f-4d19-ac63-fa7d4c500783","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","message":{"model":"claude-opus-4-5-20251101","id":"msg_bdrk_01TN5J6DS21hE6XaPtjaS6zF","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"The user wants me to use the Confluence page directly instead of the binary doc file. Let me fetch the content from the Confluence page using the available MCP tool.","signature":"EtACCkgICxABGAIqQGREMHJFMFP3ShKj/hgT6eO1e9K8DIDxKWMpmqQ41bL7W+WXlBJgydM1iDCcRFS8u5rSxUbtnzLwgnQ1W2WzDN0SDLh1R8kvahMTBjsLQhoMnfM23b26xuI6aVlNIjCKGP/7a/IwrhSSzyW0/3Z3ivReFjJcDxFZ4mNRBwQvSSMk8+VlO8vd5jCWBCTpMcAqtQHbfIjiovikSblkLlbd6ZyA7fOJZ4VSrbK4+3pznjj92mKVGF4RpRwfUj0n2ZGeeQIsjB5j1ajTD55ueHHhnTp3bri2yBDz33RScMk8WWZku0/uSeZmgMlGE7ibUwsAOtvlcyWbLTuhpN9V5Xf7x1GHSgdWZxF/SNUBelccGe3gMuuvYncfkRhBW/hI8G2RL8/wLH0ez+Kj9V+jFxpdIdM2wXs4zVGgo4rka4XSIQ2Xwr1wzm8zGAE="}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":9,"cache_creation_input_tokens":309,"cache_read_input_tokens":60921,"cache_creation":{"ephemeral_5m_input_tokens":309,"ephemeral_1h_input_tokens":0},"output_tokens":3}},"type":"assistant","uuid":"a480cff2-17d1-4235-973c-636ffb266666","timestamp":"2025-12-31T06:19:12.104Z"}
{"parentUuid":"a480cff2-17d1-4235-973c-636ffb266666","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","message":{"model":"claude-opus-4-5-20251101","id":"msg_bdrk_01TN5J6DS21hE6XaPtjaS6zF","type":"message","role":"assistant","content":[{"type":"text","text":"Let me fetch the content directly from Confluence."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":9,"cache_creation_input_tokens":309,"cache_read_input_tokens":60921,"cache_creation":{"ephemeral_5m_input_tokens":309,"ephemeral_1h_input_tokens":0},"output_tokens":3}},"type":"assistant","uuid":"7719caee-ba02-446e-bb26-d38201db201e","timestamp":"2025-12-31T06:19:12.791Z"}
{"parentUuid":"7719caee-ba02-446e-bb26-d38201db201e","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","message":{"model":"claude-opus-4-5-20251101","id":"msg_bdrk_01TN5J6DS21hE6XaPtjaS6zF","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_bdrk_014qCESwwnH6JoVxTCrnB24r","name":"mcp__mcp-atlassian__confluence_get_page","input":{"page_id":5567807498,"include_metadata":true,"convert_to_markdown":true}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":9,"cache_creation_input_tokens":309,"cache_read_input_tokens":60921,"cache_creation":{"ephemeral_5m_input_tokens":309,"ephemeral_1h_input_tokens":0},"output_tokens":3}},"type":"assistant","uuid":"9cc78c66-4c5f-495a-ac5b-4c7b56617492","timestamp":"2025-12-31T06:19:13.358Z"}
{"parentUuid":"9cc78c66-4c5f-495a-ac5b-4c7b56617492","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_bdrk_014qCESwwnH6JoVxTCrnB24r","type":"tool_result","content":"{\"result\":\"{\\n  \\\"metadata\\\": {\\n    \\\"id\\\": \\\"5567807498\\\",\\n    \\\"title\\\": \\\"Payments Evolution\\\",\\n    \\\"type\\\": \\\"page\\\",\\n    \\\"created\\\": \\\"\\\",\\n    \\\"updated\\\": \\\"\\\",\\n    \\\"url\\\": \\\"https://dreamplug.atlassian.net/wiki/spaces/~132594828/pages/5567807498\\\",\\n    \\\"space\\\": {\\n      \\\"key\\\": \\\"~132594828\\\",\\n      \\\"name\\\": \\\"Kiran Biliyawala\\\"\\n    },\\n    \\\"version\\\": 1,\\n    \\\"attachments\\\": [],\\n    \\\"content\\\": {\\n      \\\"value\\\": \\\"Background\\\\n==========\\\\n\\\\nWhen CRED started, we had `plutus` for transaction processing, acting as both order management and transaction orchestrator.\\\\n\\\\nPlutus\\\\n------\\\\n\\\\n1. `Loading` and `Fulfilment` are the key flows that plutus supports\\\\n2. `Plutus` had integration with Juspays express checkout for loading\\\\n\\\\n   1. Express checkout connects with multiple partners. Eg. Rzp, PayU, Cashfree, etc\\\\n   2. Morpheus connects with multiple partners. RBL, YBL\\\\n3. `Plutus` had integration with Juspays Morpheus for fulfilment\\\\n4. After `darwin`(in house replacement of express checkout) and `genie`(in house replacement of morpheus) got introduced, `plutus` would call darwin for loading first, and then genie for fulfilment.\\\\n5. After both loading, and fulfilment are success, plutus gives success to lob.\\\\n6. There were three types of orders:\\\\n\\\\n   1. pay/loading only\\\\n   2. loading & fulfilment: ccbp, bbps\\\\n   3. fulfilment only: cashbacks to credit card\\\\n7. Plutus was multi-tenant.\\\\n8. When fulfilment fails, plutus would trigger the auto-refund of loaded amount.\\\\n\\\\nOverall\\\\n-------\\\\n\\\\nPayments has total of 4 steps:\\\\n\\\\n1. Merchant onboarding\\\\n2. Payment readiness\\\\n3. Payment processing\\\\n4. Post-payment: refund, chargeback etc\\\\n\\\\nPayment processing\\\\n==================\\\\n\\\\nThere are two major components of payments processing:\\\\n\\\\n1. Instrument\\\\n\\\\n   1. Storage: at user level instruments\\\\n   2. Discovery: more of checkout\\\\n   3. Card tokenisation: this is limited to card tokens only. If tomorrow other instruments needs to be tokenised, things havent been thought through as of now. Liea is positioned more as a card tokenisation\\\\n2. Payments\\\\n\\\\n   1. Loading\\\\n\\\\n      1. Everything started as loading via express checkout.\\\\n      2. Juspay had two configuration models:\\\\n\\\\n         1. Configure at juspays leg to select provider\\\\n         2. Resolve the provider at client end, and share the provider in the request at transaction level.\\\\n      3. Initially we started with first model, and then when we matured a little, we moved to second configuration model.\\\\n   2. Fulfilment\\\\n\\\\n      1. Here things started as Juspays Morpheus.\\\\n\\\\nGenie\\\\n-----\\\\n\\\\nThe major problems we face are more on fulfilment. Were unable to fulfil promises, and end up refunding etc. So we planned of moving fulfilment to in-house first. As a result genie was built. Genie is multi-tenant.\\\\n\\\\n1. Genie has different payout partners/provider, supporting multiple rails/channel.\\\\n2. Genie became the replacement of Morpheus.\\\\n3. As part of migration `plutus` started calling `genie`, and `genie` was calling `Morpheus`during migration.\\\\n4. Later on, it started integrating with different partners.\\\\n5. Currently genie supports 12-13 payout partners.\\\\n6. Morpheus is no longer existing in our setup now.\\\\n7. Genie is a dpspl offering for payout, and it is used by multiple tenants, where PA is one of those tenants for payouts.\\\\n8. Genie is the only component who is involved in fund transfer\\\\n9. Genie does not have balance management of the banks.\\\\n10. Genie expects that you have a bank account, and Im one of the parties who is authorized to do the transfer.\\\\n\\\\nDarwin\\\\n------\\\\n\\\\nDarwin is similar to genie for loading part. Darwin integrates with different providers, who it will integrate to get the money. Darwin is multi-tenant.\\\\n\\\\n1. Providers definition is more of who has similar API structure/TSP.\\\\n2. The same provider like cybersource integration -\\\\n\\\\n   1. Partner Axis can give the money using one credentials\\\\n   2. Partner YBL can give the money using another credentials\\\\n3. Similar to genie model, we have Express Checkout also as another provider.\\\\n4. Express checkout still exist.\\\\n5. Every time adding a new provider needs a dev effort. So when the provider is small, and not much ROI, we use express checkout to simplify the onboarding.\\\\n\\\\nDarwin has multiple Payment Methods\\\\n\\\\n1. C-UPI started growing very fast, and we had 60% CCBP started coming in from C-UPI.\\\\n2. Darwin has different payment methods like CC, Net-Banking, DC, C-UPI, UPI(other apps).\\\\n\\\\n   1. It added CUPI as a separate method, and interface for transacting is different, than normal UPI\\\\n   2. The reason to take this decision was, so that experience, flows, and interfaces for CRED UPI vs other UPI apps.\\\\n\\\\n### Merchant Payment Orchestrator\\\\n\\\\nGiven we did not want to corrupt the darwin contracts, we introduced MPO as the wrapper layer on DTPL side that acts makes it easy for CRED to integrate.\\\\n\\\\nMajorly checkout, and some lobs who do not have checkout integrates with MPO. Currently, checkout, cash, and wealth has integration with MPO.\\\\n\\\\nDarwin is mostly backed by the MPO, direct use is rare. Limited to use cases like CRED QR etc.\\\\n\\\\n### ComponentX\\\\n\\\\n* ComponentX is a monolith of SDKs.\\\\n* It decides when to invoke which SDK, and orchestrates the flow to & from SDKs.\\\\n* It helps resolve different UPI SDK flows.\\\\n\\\\nBirth of PA\\\\n===========\\\\n\\\\nWe had 30K crore of monthly transacting amounts. At the time, we had nodal account to enable this transfers.\\\\n\\\\nFor any fund transfers, where you dont own the money, nodal account was used.\\\\n\\\\nFrom 2020 PA guidelines, RBI barred nodal accounts. And recommends to use the escrow account.\\\\n\\\\nIn escrow, most of the money is not you own, only some part is what you own. Basis nature of your business, only income part, for example MDR, fees, etc, can be part of escrow, else most of the money is something that is owned by your partners/customers\\\\n\\\\nWe can use the escrow account for tax payments of PA, but people prefer not to. They transfer money to their current account for realising the income, and then do these tax payments etc from current account itself.\\\\n\\\\nGiven, we were large business, and there was a regulatory risk in the absence, we applied for PA license. We had two options:\\\\n\\\\n1. We apply as new entity\\\\n\\\\n   1. If we apply as a new entity, RBI vets the whole company, processes, business etc before giving the license, and it brings more scrutiny.\\\\n2. We apply as existing company.\\\\n\\\\n   1. Here some business is already running, hence applying as existing company who has the PA business is comparatively easier.\\\\n   2. Hence we chose this path, because we had the running business at the time.\\\\n   3. We had some 30 nodal accounts at the time. And shared ccbp is the fund aggregator use case. This got signed off, that yes it is an existing entity.\\\\n\\\\nWe could have chosen to make either DTPL as a PA entity, or create a new entity. We chose the path of creating new entity DPSPL, to avoid customer facing company having any regulatory scrutiny.\\\\n\\\\nAt the time, all the existing service of plutus, darwin, genie etc were part of DTPL. Darwin, Genie, and card tokenisation/leia were recognised as PA components, we moved these to DPSPL.\\\\n\\\\nPlutus continued to call darwin/genie etc in new dpspl environment. And bill payments were working in this new setup. Other systems/components were built later on for other merchants later on.\\\\n\\\\nNarad\\\\n-----\\\\n\\\\n1. near real time routing logic\\\\n2. it integrates with downtime detection models, and works on success rates etc\\\\n3. it routes to another provider within 3 minutes when something starts failing\\\\n\\\\nMandates\\\\n--------\\\\n\\\\n* Originally only standard payments were supported, for supporting mandates, mandate service is built.\\\\n* The nuances among darwin and mandate service has very thin boundary, so externally its the same.\\\\n\\\\nMerchants as Entity in PA\\\\n=========================\\\\n\\\\nWe have a merchant service for merchant onboarding/management, and we use jocata for AML flows.\\\\n\\\\n* Dunzo/Swiggy was one of the first merchants. Where we created the CRED Pay, and this dunzo/swiggy became other merchants, other than DTPL(being used for bill payments).\\\\n* Here, user flows, such as instrument discovery, reward/offer, etc becomes key. This is solved using heimdall from DTPL side, and darwin was helping solve the same on payments side.\\\\n* When the money hits the escrow account, someone needs to aggregate the amount per day, to compute MDR, and then transfer the remaining to merchant. To support this, there was a configurable script was created for a merchant called SCAR. Originally scar used heimdal and genie to identify the transactions to aggregate. Later on settlement engine was created to replace this, and do it properly in dpspl.\\\\n* Settlement engine has an accounting, that does the aggregation, computes fees using a fee rule engine using service called tyrion, and computes the amount to settle.\\\\n* And finally genie is used to do the settlement. Before settlement engine, scar also used genie only for the fund transfer.\\\\n* MCC is not standardised in industry, we have used npci mcc definition for our own mccs.\\\\n* As part of payment readiness, as part of merchant onboarding, the configuration of MCC is created for the supported payment instruments.\\\\n\\\\nLCM (Loading Capability Manager)\\\\n--------------------------------\\\\n\\\\n* as part of merchant onboarding, given mcc level type of payment instruments are configured, this helps validate which all instruments are allowed for a transaction/merchant.\\\\n* in the absence of LCM, darwin was having routing logic for each merchant. And as part of this, the routing did not exist for unsupported instruments, and PA would fail the transaction if let say credit card is used for paying a loan.\\\\n* for every new use case we create a new terminal, and configure the same in lcm.\\\",\\n      \\\"format\\\": \\\"markdown\\\"\\n    }\\n  }\\n}\"}"}]},"uuid":"4dfbca4a-5bde-488d-bfcf-996fa79988e2","timestamp":"2025-12-31T06:19:13.846Z","toolUseResult":"{\"result\":\"{\\n  \\\"metadata\\\": {\\n    \\\"id\\\": \\\"5567807498\\\",\\n    \\\"title\\\": \\\"Payments Evolution\\\",\\n    \\\"type\\\": \\\"page\\\",\\n    \\\"created\\\": \\\"\\\",\\n    \\\"updated\\\": \\\"\\\",\\n    \\\"url\\\": \\\"https://dreamplug.atlassian.net/wiki/spaces/~132594828/pages/5567807498\\\",\\n    \\\"space\\\": {\\n      \\\"key\\\": \\\"~132594828\\\",\\n      \\\"name\\\": \\\"Kiran Biliyawala\\\"\\n    },\\n    \\\"version\\\": 1,\\n    \\\"attachments\\\": [],\\n    \\\"content\\\": {\\n      \\\"value\\\": \\\"Background\\\\n==========\\\\n\\\\nWhen CRED started, we had `plutus` for transaction processing, acting as both order management and transaction orchestrator.\\\\n\\\\nPlutus\\\\n------\\\\n\\\\n1. `Loading` and `Fulfilment` are the key flows that plutus supports\\\\n2. `Plutus` had integration with Juspays express checkout for loading\\\\n\\\\n   1. Express checkout connects with multiple partners. Eg. Rzp, PayU, Cashfree, etc\\\\n   2. Morpheus connects with multiple partners. RBL, YBL\\\\n3. `Plutus` had integration with Juspays Morpheus for fulfilment\\\\n4. After `darwin`(in house replacement of express checkout) and `genie`(in house replacement of morpheus) got introduced, `plutus` would call darwin for loading first, and then genie for fulfilment.\\\\n5. After both loading, and fulfilment are success, plutus gives success to lob.\\\\n6. There were three types of orders:\\\\n\\\\n   1. pay/loading only\\\\n   2. loading & fulfilment: ccbp, bbps\\\\n   3. fulfilment only: cashbacks to credit card\\\\n7. Plutus was multi-tenant.\\\\n8. When fulfilment fails, plutus would trigger the auto-refund of loaded amount.\\\\n\\\\nOverall\\\\n-------\\\\n\\\\nPayments has total of 4 steps:\\\\n\\\\n1. Merchant onboarding\\\\n2. Payment readiness\\\\n3. Payment processing\\\\n4. Post-payment: refund, chargeback etc\\\\n\\\\nPayment processing\\\\n==================\\\\n\\\\nThere are two major components of payments processing:\\\\n\\\\n1. Instrument\\\\n\\\\n   1. Storage: at user level instruments\\\\n   2. Discovery: more of checkout\\\\n   3. Card tokenisation: this is limited to card tokens only. If tomorrow other instruments needs to be tokenised, things havent been thought through as of now. Liea is positioned more as a card tokenisation\\\\n2. Payments\\\\n\\\\n   1. Loading\\\\n\\\\n      1. Everything started as loading via express checkout.\\\\n      2. Juspay had two configuration models:\\\\n\\\\n         1. Configure at juspays leg to select provider\\\\n         2. Resolve the provider at client end, and share the provider in the request at transaction level.\\\\n      3. Initially we started with first model, and then when we matured a little, we moved to second configuration model.\\\\n   2. Fulfilment\\\\n\\\\n      1. Here things started as Juspays Morpheus.\\\\n\\\\nGenie\\\\n-----\\\\n\\\\nThe major problems we face are more on fulfilment. Were unable to fulfil promises, and end up refunding etc. So we planned of moving fulfilment to in-house first. As a result genie was built. Genie is multi-tenant.\\\\n\\\\n1. Genie has different payout partners/provider, supporting multiple rails/channel.\\\\n2. Genie became the replacement of Morpheus.\\\\n3. As part of migration `plutus` started calling `genie`, and `genie` was calling `Morpheus`during migration.\\\\n4. Later on, it started integrating with different partners.\\\\n5. Currently genie supports 12-13 payout partners.\\\\n6. Morpheus is no longer existing in our setup now.\\\\n7. Genie is a dpspl offering for payout, and it is used by multiple tenants, where PA is one of those tenants for payouts.\\\\n8. Genie is the only component who is involved in fund transfer\\\\n9. Genie does not have balance management of the banks.\\\\n10. Genie expects that you have a bank account, and Im one of the parties who is authorized to do the transfer.\\\\n\\\\nDarwin\\\\n------\\\\n\\\\nDarwin is similar to genie for loading part. Darwin integrates with different providers, who it will integrate to get the money. Darwin is multi-tenant.\\\\n\\\\n1. Providers definition is more of who has similar API structure/TSP.\\\\n2. The same provider like cybersource integration -\\\\n\\\\n   1. Partner Axis can give the money using one credentials\\\\n   2. Partner YBL can give the money using another credentials\\\\n3. Similar to genie model, we have Express Checkout also as another provider.\\\\n4. Express checkout still exist.\\\\n5. Every time adding a new provider needs a dev effort. So when the provider is small, and not much ROI, we use express checkout to simplify the onboarding.\\\\n\\\\nDarwin has multiple Payment Methods\\\\n\\\\n1. C-UPI started growing very fast, and we had 60% CCBP started coming in from C-UPI.\\\\n2. Darwin has different payment methods like CC, Net-Banking, DC, C-UPI, UPI(other apps).\\\\n\\\\n   1. It added CUPI as a separate method, and interface for transacting is different, than normal UPI\\\\n   2. The reason to take this decision was, so that experience, flows, and interfaces for CRED UPI vs other UPI apps.\\\\n\\\\n### Merchant Payment Orchestrator\\\\n\\\\nGiven we did not want to corrupt the darwin contracts, we introduced MPO as the wrapper layer on DTPL side that acts makes it easy for CRED to integrate.\\\\n\\\\nMajorly checkout, and some lobs who do not have checkout integrates with MPO. Currently, checkout, cash, and wealth has integration with MPO.\\\\n\\\\nDarwin is mostly backed by the MPO, direct use is rare. Limited to use cases like CRED QR etc.\\\\n\\\\n### ComponentX\\\\n\\\\n* ComponentX is a monolith of SDKs.\\\\n* It decides when to invoke which SDK, and orchestrates the flow to & from SDKs.\\\\n* It helps resolve different UPI SDK flows.\\\\n\\\\nBirth of PA\\\\n===========\\\\n\\\\nWe had 30K crore of monthly transacting amounts. At the time, we had nodal account to enable this transfers.\\\\n\\\\nFor any fund transfers, where you dont own the money, nodal account was used.\\\\n\\\\nFrom 2020 PA guidelines, RBI barred nodal accounts. And recommends to use the escrow account.\\\\n\\\\nIn escrow, most of the money is not you own, only some part is what you own. Basis nature of your business, only income part, for example MDR, fees, etc, can be part of escrow, else most of the money is something that is owned by your partners/customers\\\\n\\\\nWe can use the escrow account for tax payments of PA, but people prefer not to. They transfer money to their current account for realising the income, and then do these tax payments etc from current account itself.\\\\n\\\\nGiven, we were large business, and there was a regulatory risk in the absence, we applied for PA license. We had two options:\\\\n\\\\n1. We apply as new entity\\\\n\\\\n   1. If we apply as a new entity, RBI vets the whole company, processes, business etc before giving the license, and it brings more scrutiny.\\\\n2. We apply as existing company.\\\\n\\\\n   1. Here some business is already running, hence applying as existing company who has the PA business is comparatively easier.\\\\n   2. Hence we chose this path, because we had the running business at the time.\\\\n   3. We had some 30 nodal accounts at the time. And shared ccbp is the fund aggregator use case. This got signed off, that yes it is an existing entity.\\\\n\\\\nWe could have chosen to make either DTPL as a PA entity, or create a new entity. We chose the path of creating new entity DPSPL, to avoid customer facing company having any regulatory scrutiny.\\\\n\\\\nAt the time, all the existing service of plutus, darwin, genie etc were part of DTPL. Darwin, Genie, and card tokenisation/leia were recognised as PA components, we moved these to DPSPL.\\\\n\\\\nPlutus continued to call darwin/genie etc in new dpspl environment. And bill payments were working in this new setup. Other systems/components were built later on for other merchants later on.\\\\n\\\\nNarad\\\\n-----\\\\n\\\\n1. near real time routing logic\\\\n2. it integrates with downtime detection models, and works on success rates etc\\\\n3. it routes to another provider within 3 minutes when something starts failing\\\\n\\\\nMandates\\\\n--------\\\\n\\\\n* Originally only standard payments were supported, for supporting mandates, mandate service is built.\\\\n* The nuances among darwin and mandate service has very thin boundary, so externally its the same.\\\\n\\\\nMerchants as Entity in PA\\\\n=========================\\\\n\\\\nWe have a merchant service for merchant onboarding/management, and we use jocata for AML flows.\\\\n\\\\n* Dunzo/Swiggy was one of the first merchants. Where we created the CRED Pay, and this dunzo/swiggy became other merchants, other than DTPL(being used for bill payments).\\\\n* Here, user flows, such as instrument discovery, reward/offer, etc becomes key. This is solved using heimdall from DTPL side, and darwin was helping solve the same on payments side.\\\\n* When the money hits the escrow account, someone needs to aggregate the amount per day, to compute MDR, and then transfer the remaining to merchant. To support this, there was a configurable script was created for a merchant called SCAR. Originally scar used heimdal and genie to identify the transactions to aggregate. Later on settlement engine was created to replace this, and do it properly in dpspl.\\\\n* Settlement engine has an accounting, that does the aggregation, computes fees using a fee rule engine using service called tyrion, and computes the amount to settle.\\\\n* And finally genie is used to do the settlement. Before settlement engine, scar also used genie only for the fund transfer.\\\\n* MCC is not standardised in industry, we have used npci mcc definition for our own mccs.\\\\n* As part of payment readiness, as part of merchant onboarding, the configuration of MCC is created for the supported payment instruments.\\\\n\\\\nLCM (Loading Capability Manager)\\\\n--------------------------------\\\\n\\\\n* as part of merchant onboarding, given mcc level type of payment instruments are configured, this helps validate which all instruments are allowed for a transaction/merchant.\\\\n* in the absence of LCM, darwin was having routing logic for each merchant. And as part of this, the routing did not exist for unsupported instruments, and PA would fail the transaction if let say credit card is used for paying a loan.\\\\n* for every new use case we create a new terminal, and configure the same in lcm.\\\",\\n      \\\"format\\\": \\\"markdown\\\"\\n    }\\n  }\\n}\"}"}
{"parentUuid":"4dfbca4a-5bde-488d-bfcf-996fa79988e2","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","message":{"model":"claude-opus-4-5-20251101","id":"msg_bdrk_01NKjgvqaqS9CyV2podkipRc","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"I now have the full content from the Confluence page. Let me create a well-structured, refined markdown document that:\n1. Preserves all the details\n2. Improves the language and sentence structure\n3. Maintains a similar format\n4. Makes it more readable and professional\n\nI'll write this to a markdown file in the current working directory or an appropriate location.","signature":"EpUECkgICxABGAIqQPZrb5Hazyhg8jSMzpiJDNzIvZNm4p+DOSTSWnC3qs8GlYnizpFBlXO5VQjsayYbM7fUGHNZnwQscFwLtMFP7pwSDGT7FbzbmVFtl/fjQxoMwC5/YoUviAN1DyJfIjD2vePfugseNh0EYCjnkY54c/4bLuIAHQHk8C8GWulG0yB5+21JEiraxEqT8vGpXaoq+gILiDHFo4IgPQ4wr1XFDnLlyuRPkiVwmE3aJWiw+LxHWNLsORM4QhFUbM7VKXkqbJI5Ko7mf5vGgTLrINCUvP+/HdTPBpouA8+ianH0+TqA6BdhTe7aKAIE1NUPGUBwRSGIdweXIX0YjzlPg5+C5kRIfIIQ9a6LsyTTa4FR6l2qiVhBzSlERjHfr5lKJaluSjqR/ftYxuHJBUoRkF4J6nEr0ErLaBDJ7wVn3JHWPetGaooiWiqSCAQDPamGDSwLxtuiUECdYYUKUw/RbvNvepM09uEsDsv0N+cS2W5+fpFGyqN2kH+7XMeRTWMBuJl4ZxKWImVOqCl0k4Lejqgdl6CdwZzat62FdxAB7K7bI9C/C1wvYbFTzLRzsAuF3CizQOfx6ykAKFtiMFUAXyvZEkopQiklPEqeyK0F7hTP/xIMtoLA/EPZFyWr6v8AyGtZBqeTHxeIhnnckTKB6CTRKHCOWvT/6tktpmBqsXmvMwRX0RsuvOYcaDsg62oYAQ=="}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":7,"cache_creation_input_tokens":3070,"cache_read_input_tokens":61230,"cache_creation":{"ephemeral_5m_input_tokens":3070,"ephemeral_1h_input_tokens":0},"output_tokens":1}},"type":"assistant","uuid":"7534f714-4b84-4174-bfdb-e74f9daef019","timestamp":"2025-12-31T06:19:18.941Z"}
{"parentUuid":"7534f714-4b84-4174-bfdb-e74f9daef019","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","message":{"model":"claude-opus-4-5-20251101","id":"msg_bdrk_01NKjgvqaqS9CyV2podkipRc","type":"message","role":"assistant","content":[{"type":"text","text":"I have the content. Let me create a refined markdown document with improved language and structure while preserving all the details."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":7,"cache_creation_input_tokens":3070,"cache_read_input_tokens":61230,"cache_creation":{"ephemeral_5m_input_tokens":3070,"ephemeral_1h_input_tokens":0},"output_tokens":1}},"type":"assistant","uuid":"a941bbfa-35d6-44d4-bbb7-1b794be0d7a3","timestamp":"2025-12-31T06:19:20.068Z"}
{"parentUuid":"a941bbfa-35d6-44d4-bbb7-1b794be0d7a3","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","message":{"model":"claude-opus-4-5-20251101","id":"msg_bdrk_01NKjgvqaqS9CyV2podkipRc","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_bdrk_018uaFu1jNSq5H63H9H6DzVp","name":"Write","input":{"file_path":"/Users/kiranbiliyawala/code/cred/payments/Payments_Evolution.md","content":"# Payments Evolution\n\n## Background\n\nWhen CRED launched, **Plutus** served as the primary transaction processing system, functioning as both the order management system and the transaction orchestrator.\n\n---\n\n## Plutus\n\nPlutus was the foundational payment system with the following characteristics:\n\n1. **Core Flows**: `Loading` and `Fulfilment` are the two key flows that Plutus supports.\n\n2. **Loading Integration**: Plutus integrated with Juspay's Express Checkout for loading operations.\n   - Express Checkout connects with multiple payment partners (e.g., Razorpay, PayU, Cashfree, etc.)\n   - Morpheus connects with multiple banking partners (e.g., RBL, YBL)\n\n3. **Fulfilment Integration**: Plutus integrated with Juspay's Morpheus for fulfilment operations.\n\n4. **In-House Transition**: After `Darwin` (in-house replacement for Express Checkout) and `Genie` (in-house replacement for Morpheus) were introduced, Plutus began calling Darwin for loading first, followed by Genie for fulfilment.\n\n5. **Success Flow**: Plutus returns success to the Line of Business (LOB) only after both loading and fulfilment are successful.\n\n6. **Order Types**: Three types of orders were supported:\n   - **Pay/Loading Only**: Simple payment transactions\n   - **Loading & Fulfilment**: Credit card bill payments (CCBP), BBPS transactions\n   - **Fulfilment Only**: Cashbacks to credit cards\n\n7. **Multi-Tenancy**: Plutus was designed as a multi-tenant system.\n\n8. **Auto-Refund**: When fulfilment fails, Plutus automatically triggers a refund of the loaded amount.\n\n---\n\n## Overall Payment Flow\n\nThe complete payments lifecycle consists of four stages:\n\n1. **Merchant Onboarding**: Initial setup and registration of merchants\n2. **Payment Readiness**: Configuration and preparation for accepting payments\n3. **Payment Processing**: Actual transaction execution\n4. **Post-Payment Operations**: Refunds, chargebacks, reconciliation, etc.\n\n---\n\n# Payment Processing\n\nPayment processing comprises two major components:\n\n## 1. Instrument Management\n\n- **Storage**: User-level instrument storage and management\n- **Discovery**: Primarily handled through the checkout experience\n- **Card Tokenisation**: Currently limited to card tokens only through Leia. Tokenisation for other instrument types has not been architected yet. Leia is positioned specifically as a card tokenisation service.\n\n## 2. Payments\n\n### Loading\n\n1. All loading operations initially went through Express Checkout.\n\n2. Juspay offered two configuration models:\n   - **Juspay-Side Configuration**: Provider selection configured at Juspay's end\n   - **Client-Side Resolution**: Provider resolved at the client end and passed in the transaction request\n\n3. CRED initially adopted the first model, then migrated to the second configuration model as the system matured.\n\n### Fulfilment\n\n1. Fulfilment operations initially used Juspay's Morpheus service.\n\n---\n\n## Genie\n\nFulfilment presented the most significant operational challengesfrequent failures led to unfulfilled promises and refunds. To address this, an in-house fulfilment system was developed. **Genie** was built as a multi-tenant solution.\n\n### Key Characteristics\n\n1. **Multiple Payout Partners**: Genie supports various payout partners/providers across multiple rails and channels.\n\n2. **Morpheus Replacement**: Genie became the complete replacement for Morpheus.\n\n3. **Migration Strategy**: During migration, Plutus started calling Genie, which in turn called Morpheus. This allowed for a gradual, risk-mitigated transition.\n\n4. **Partner Integration**: Over time, Genie integrated directly with different payout partners.\n\n5. **Current State**: Genie currently supports 12-13 payout partners. Morpheus is no longer part of the system.\n\n6. **DPSPL Offering**: Genie is a DPSPL offering for payouts, used by multiple tenants. PA (Payment Aggregator) is one of these tenants.\n\n7. **Fund Transfer Authority**: Genie is the sole component responsible for actual fund transfers.\n\n8. **Balance Management**: Genie does not handle bank balance management.\n\n9. **Authorization Model**: Genie operates on the assumption that a bank account exists, and it is authorized to execute transfers from that account.\n\n---\n\n## Darwin\n\nDarwin serves a similar purpose as Genie but for the loading side. It integrates with various providers to collect funds. Darwin is also a multi-tenant system.\n\n### Provider Architecture\n\n1. **Provider Definition**: A \"provider\" is defined by similar API structure/TSP (Technical Service Provider).\n\n2. **Credential-Based Routing**: The same provider integration (e.g., Cybersource) can route to different partners:\n   - Partner Axis: Uses one set of credentials\n   - Partner YBL: Uses another set of credentials\n\n3. **Express Checkout as Provider**: Similar to the Genie model, Express Checkout is available as another provider option.\n\n4. **Express Checkout Availability**: Express Checkout continues to exist in the system.\n\n5. **Provider Onboarding Trade-off**: Adding new providers requires development effort. For smaller providers with limited ROI, Express Checkout is used to simplify onboarding.\n\n### Payment Methods\n\n1. **C-UPI Growth**: CRED UPI (C-UPI) experienced rapid growth, with 60% of CCBP transactions originating from C-UPI.\n\n2. **Supported Methods**: Darwin supports multiple payment methods:\n   - Credit Card (CC)\n   - Net Banking\n   - Debit Card (DC)\n   - CRED UPI (C-UPI)\n   - UPI (other apps)\n\n3. **C-UPI as Separate Method**: C-UPI was implemented as a distinct payment method with a different transacting interface compared to standard UPI. This decision enabled differentiated experiences, flows, and interfaces between CRED UPI and other UPI applications.\n\n### Merchant Payment Orchestrator (MPO)\n\nTo preserve Darwin's contract integrity, **MPO** was introduced as a wrapper layer on the DTPL side, simplifying integration for CRED.\n\n- **Primary Integrators**: Checkout and select LOBs without checkout integration use MPO. Currently, Checkout, Cash, and Wealth have MPO integration.\n- **Usage Pattern**: Darwin is predominantly accessed through MPO. Direct Darwin usage is rare and limited to specific use cases like CRED QR.\n\n### ComponentX\n\n- ComponentX is a monolithic collection of SDKs.\n- It determines which SDK to invoke and orchestrates the flow to and from various SDKs.\n- It resolves different UPI SDK flows.\n\n---\n\n# Birth of PA (Payment Aggregator)\n\n## Regulatory Context\n\nCRED was processing approximately **30,000 crore in monthly transaction volume**. At that time, nodal accounts facilitated these transfers.\n\n### Nodal Accounts\n- Used for fund transfers where the funds are not owned by the entity\n- RBI's 2020 PA guidelines barred the use of nodal accounts\n- RBI recommended migrating to escrow accounts\n\n### Escrow Accounts\n- Most funds in escrow are not owned by the entity\n- Only income-related amounts (MDR, fees, etc.) belong to the entity\n- The majority of funds are owned by partners or customers\n- While escrow accounts can be used for PA tax payments, entities typically transfer funds to current accounts to realise income before making tax payments\n\n## License Application Strategy\n\nGiven the large transaction volume and regulatory risk, CRED applied for a PA license. Two paths were available:\n\n### Option 1: Apply as New Entity\n- RBI conducts comprehensive vetting of the company, processes, and business\n- Involves greater scrutiny and longer approval timelines\n\n### Option 2: Apply as Existing Company (Chosen Path)\n- Comparatively easier for companies with existing PA business operations\n- CRED had approximately 30 nodal accounts at the time\n- Shared CCBP was presented as the fund aggregator use case\n- Successfully validated as an existing entity\n\n## Entity Structure Decision\n\nRather than designating DTPL as the PA entity, CRED created a new entity**DPSPL**to shield the customer-facing company from regulatory scrutiny.\n\n### Migration to DPSPL\n- Originally, Plutus, Darwin, Genie, and other services resided within DTPL\n- Darwin, Genie, and card tokenisation (Leia) were identified as PA components and migrated to DPSPL\n- Plutus continued calling Darwin/Genie in the new DPSPL environment\n- Bill payments operated successfully in this new setup\n- Additional systems and components were built later for other merchants\n\n---\n\n## Narad\n\nNarad provides **near real-time routing logic** for payment processing.\n\n1. Integrates with downtime detection models and monitors success rates\n2. Automatically routes to an alternate provider within 3 minutes when failures are detected\n3. Ensures high availability and optimal transaction success rates\n\n---\n\n## Mandates\n\n- Originally, only standard one-time payments were supported\n- A dedicated **Mandate Service** was built to support recurring payment mandates\n- The distinction between Darwin and Mandate Service is minimal from an external perspectivethey appear as a unified system\n\n---\n\n# Merchants as Entity in PA\n\n## Merchant Management\n\n- **Merchant Service**: Handles merchant onboarding and management\n- **Jocata**: Used for AML (Anti-Money Laundering) compliance flows\n\n## External Merchant Onboarding\n\n- **First External Merchants**: Dunzo and Swiggy were among the first external merchants\n- **CRED Pay**: Created to serve these merchants, expanding beyond DTPL (which handled bill payments)\n\n## User Experience Components\n\nUser flows such as instrument discovery and reward/offer presentation are critical for external merchants:\n- **Heimdall** (DTPL): Solves user experience challenges\n- **Darwin**: Addresses payment-side requirements\n\n## Settlement Flow\n\n### SCAR (Initial Approach)\nWhen funds hit the escrow account, daily aggregation is required to:\n- Compute MDR (Merchant Discount Rate)\n- Transfer the remaining amount to merchants\n\nA configurable script called **SCAR** was initially created for merchant settlements. SCAR used Heimdall and Genie to identify transactions for aggregation.\n\n### Settlement Engine (Current Approach)\n**Settlement Engine** replaced SCAR to handle settlements properly within DPSPL:\n- **Accounting Module**: Performs transaction aggregation\n- **Tyrion**: Fee rule engine that computes fees\n- **Settlement Calculation**: Determines the final settlement amount\n- **Genie**: Executes the actual fund transfer\n\n## MCC (Merchant Category Code)\n\n- MCC is not standardised across the industry\n- CRED adopted NPCI's MCC definitions for internal use\n- During payment readiness (as part of merchant onboarding), MCC configuration is created for supported payment instruments\n\n---\n\n## LCM (Loading Capability Manager)\n\nLCM validates which payment instruments are permitted for specific transactions and merchants.\n\n### Key Functions\n\n1. **Instrument Validation**: Based on MCC-level payment instrument configuration during merchant onboarding, LCM validates allowed instruments for each transaction/merchant combination.\n\n2. **Historical Context**: Before LCM, Darwin maintained routing logic for each merchant. Unsupported instruments had no routing configuration, causing PA to fail transactions (e.g., credit card used for loan payments).\n\n3. **Terminal Management**: For each new use case, a new terminal is created and configured in LCM.\n\n---\n\n## Key System Components Summary\n\n| Component | Function | Entity |\n|-----------|----------|--------|\n| **Plutus** | Order management & transaction orchestration | DTPL |\n| **Darwin** | Loading/payment collection | DPSPL |\n| **Genie** | Fulfilment/payout execution | DPSPL |\n| **Leia** | Card tokenisation | DPSPL |\n| **MPO** | Darwin wrapper for simplified integration | DTPL |\n| **Narad** | Real-time routing logic | DPSPL |\n| **Settlement Engine** | Settlement aggregation & calculation | DPSPL |\n| **Tyrion** | Fee rule engine | DPSPL |\n| **LCM** | Loading capability management | DPSPL |\n| **Heimdall** | User flows (instrument discovery, rewards) | DTPL |\n| **ComponentX** | SDK orchestration | - |\n| **Merchant Service** | Merchant onboarding/management | DPSPL |\n| **Jocata** | AML compliance | External |\n"}}],"stop_reason":"tool_use","stop_sequence":null,"usage":{"input_tokens":7,"cache_creation_input_tokens":3070,"cache_read_input_tokens":61230,"cache_creation":{"ephemeral_5m_input_tokens":3070,"ephemeral_1h_input_tokens":0},"output_tokens":3173}},"type":"assistant","uuid":"6aa9ad29-4af0-429a-817f-7b56f1a3f495","timestamp":"2025-12-31T06:20:01.652Z"}
{"type":"file-history-snapshot","messageId":"6aa9ad29-4af0-429a-817f-7b56f1a3f495","snapshot":{"messageId":"c52a9b9c-785f-4d19-ac63-fa7d4c500783","trackedFileBackups":{"Payments_Evolution.md":{"backupFileName":null,"version":1,"backupTime":"2025-12-31T06:21:18.064Z"}},"timestamp":"2025-12-31T06:19:07.308Z"},"isSnapshotUpdate":true}
{"parentUuid":"6aa9ad29-4af0-429a-817f-7b56f1a3f495","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","slug":"harmonic-yawning-mitten","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_bdrk_018uaFu1jNSq5H63H9H6DzVp","type":"tool_result","content":"File created successfully at: /Users/kiranbiliyawala/code/cred/payments/Payments_Evolution.md"}]},"uuid":"f3fda6bc-0086-4335-9e67-327d64a8de68","timestamp":"2025-12-31T06:21:18.155Z","toolUseResult":{"type":"create","filePath":"/Users/kiranbiliyawala/code/cred/payments/Payments_Evolution.md","content":"# Payments Evolution\n\n## Background\n\nWhen CRED launched, **Plutus** served as the primary transaction processing system, functioning as both the order management system and the transaction orchestrator.\n\n---\n\n## Plutus\n\nPlutus was the foundational payment system with the following characteristics:\n\n1. **Core Flows**: `Loading` and `Fulfilment` are the two key flows that Plutus supports.\n\n2. **Loading Integration**: Plutus integrated with Juspay's Express Checkout for loading operations.\n   - Express Checkout connects with multiple payment partners (e.g., Razorpay, PayU, Cashfree, etc.)\n   - Morpheus connects with multiple banking partners (e.g., RBL, YBL)\n\n3. **Fulfilment Integration**: Plutus integrated with Juspay's Morpheus for fulfilment operations.\n\n4. **In-House Transition**: After `Darwin` (in-house replacement for Express Checkout) and `Genie` (in-house replacement for Morpheus) were introduced, Plutus began calling Darwin for loading first, followed by Genie for fulfilment.\n\n5. **Success Flow**: Plutus returns success to the Line of Business (LOB) only after both loading and fulfilment are successful.\n\n6. **Order Types**: Three types of orders were supported:\n   - **Pay/Loading Only**: Simple payment transactions\n   - **Loading & Fulfilment**: Credit card bill payments (CCBP), BBPS transactions\n   - **Fulfilment Only**: Cashbacks to credit cards\n\n7. **Multi-Tenancy**: Plutus was designed as a multi-tenant system.\n\n8. **Auto-Refund**: When fulfilment fails, Plutus automatically triggers a refund of the loaded amount.\n\n---\n\n## Overall Payment Flow\n\nThe complete payments lifecycle consists of four stages:\n\n1. **Merchant Onboarding**: Initial setup and registration of merchants\n2. **Payment Readiness**: Configuration and preparation for accepting payments\n3. **Payment Processing**: Actual transaction execution\n4. **Post-Payment Operations**: Refunds, chargebacks, reconciliation, etc.\n\n---\n\n# Payment Processing\n\nPayment processing comprises two major components:\n\n## 1. Instrument Management\n\n- **Storage**: User-level instrument storage and management\n- **Discovery**: Primarily handled through the checkout experience\n- **Card Tokenisation**: Currently limited to card tokens only through Leia. Tokenisation for other instrument types has not been architected yet. Leia is positioned specifically as a card tokenisation service.\n\n## 2. Payments\n\n### Loading\n\n1. All loading operations initially went through Express Checkout.\n\n2. Juspay offered two configuration models:\n   - **Juspay-Side Configuration**: Provider selection configured at Juspay's end\n   - **Client-Side Resolution**: Provider resolved at the client end and passed in the transaction request\n\n3. CRED initially adopted the first model, then migrated to the second configuration model as the system matured.\n\n### Fulfilment\n\n1. Fulfilment operations initially used Juspay's Morpheus service.\n\n---\n\n## Genie\n\nFulfilment presented the most significant operational challengesfrequent failures led to unfulfilled promises and refunds. To address this, an in-house fulfilment system was developed. **Genie** was built as a multi-tenant solution.\n\n### Key Characteristics\n\n1. **Multiple Payout Partners**: Genie supports various payout partners/providers across multiple rails and channels.\n\n2. **Morpheus Replacement**: Genie became the complete replacement for Morpheus.\n\n3. **Migration Strategy**: During migration, Plutus started calling Genie, which in turn called Morpheus. This allowed for a gradual, risk-mitigated transition.\n\n4. **Partner Integration**: Over time, Genie integrated directly with different payout partners.\n\n5. **Current State**: Genie currently supports 12-13 payout partners. Morpheus is no longer part of the system.\n\n6. **DPSPL Offering**: Genie is a DPSPL offering for payouts, used by multiple tenants. PA (Payment Aggregator) is one of these tenants.\n\n7. **Fund Transfer Authority**: Genie is the sole component responsible for actual fund transfers.\n\n8. **Balance Management**: Genie does not handle bank balance management.\n\n9. **Authorization Model**: Genie operates on the assumption that a bank account exists, and it is authorized to execute transfers from that account.\n\n---\n\n## Darwin\n\nDarwin serves a similar purpose as Genie but for the loading side. It integrates with various providers to collect funds. Darwin is also a multi-tenant system.\n\n### Provider Architecture\n\n1. **Provider Definition**: A \"provider\" is defined by similar API structure/TSP (Technical Service Provider).\n\n2. **Credential-Based Routing**: The same provider integration (e.g., Cybersource) can route to different partners:\n   - Partner Axis: Uses one set of credentials\n   - Partner YBL: Uses another set of credentials\n\n3. **Express Checkout as Provider**: Similar to the Genie model, Express Checkout is available as another provider option.\n\n4. **Express Checkout Availability**: Express Checkout continues to exist in the system.\n\n5. **Provider Onboarding Trade-off**: Adding new providers requires development effort. For smaller providers with limited ROI, Express Checkout is used to simplify onboarding.\n\n### Payment Methods\n\n1. **C-UPI Growth**: CRED UPI (C-UPI) experienced rapid growth, with 60% of CCBP transactions originating from C-UPI.\n\n2. **Supported Methods**: Darwin supports multiple payment methods:\n   - Credit Card (CC)\n   - Net Banking\n   - Debit Card (DC)\n   - CRED UPI (C-UPI)\n   - UPI (other apps)\n\n3. **C-UPI as Separate Method**: C-UPI was implemented as a distinct payment method with a different transacting interface compared to standard UPI. This decision enabled differentiated experiences, flows, and interfaces between CRED UPI and other UPI applications.\n\n### Merchant Payment Orchestrator (MPO)\n\nTo preserve Darwin's contract integrity, **MPO** was introduced as a wrapper layer on the DTPL side, simplifying integration for CRED.\n\n- **Primary Integrators**: Checkout and select LOBs without checkout integration use MPO. Currently, Checkout, Cash, and Wealth have MPO integration.\n- **Usage Pattern**: Darwin is predominantly accessed through MPO. Direct Darwin usage is rare and limited to specific use cases like CRED QR.\n\n### ComponentX\n\n- ComponentX is a monolithic collection of SDKs.\n- It determines which SDK to invoke and orchestrates the flow to and from various SDKs.\n- It resolves different UPI SDK flows.\n\n---\n\n# Birth of PA (Payment Aggregator)\n\n## Regulatory Context\n\nCRED was processing approximately **30,000 crore in monthly transaction volume**. At that time, nodal accounts facilitated these transfers.\n\n### Nodal Accounts\n- Used for fund transfers where the funds are not owned by the entity\n- RBI's 2020 PA guidelines barred the use of nodal accounts\n- RBI recommended migrating to escrow accounts\n\n### Escrow Accounts\n- Most funds in escrow are not owned by the entity\n- Only income-related amounts (MDR, fees, etc.) belong to the entity\n- The majority of funds are owned by partners or customers\n- While escrow accounts can be used for PA tax payments, entities typically transfer funds to current accounts to realise income before making tax payments\n\n## License Application Strategy\n\nGiven the large transaction volume and regulatory risk, CRED applied for a PA license. Two paths were available:\n\n### Option 1: Apply as New Entity\n- RBI conducts comprehensive vetting of the company, processes, and business\n- Involves greater scrutiny and longer approval timelines\n\n### Option 2: Apply as Existing Company (Chosen Path)\n- Comparatively easier for companies with existing PA business operations\n- CRED had approximately 30 nodal accounts at the time\n- Shared CCBP was presented as the fund aggregator use case\n- Successfully validated as an existing entity\n\n## Entity Structure Decision\n\nRather than designating DTPL as the PA entity, CRED created a new entity**DPSPL**to shield the customer-facing company from regulatory scrutiny.\n\n### Migration to DPSPL\n- Originally, Plutus, Darwin, Genie, and other services resided within DTPL\n- Darwin, Genie, and card tokenisation (Leia) were identified as PA components and migrated to DPSPL\n- Plutus continued calling Darwin/Genie in the new DPSPL environment\n- Bill payments operated successfully in this new setup\n- Additional systems and components were built later for other merchants\n\n---\n\n## Narad\n\nNarad provides **near real-time routing logic** for payment processing.\n\n1. Integrates with downtime detection models and monitors success rates\n2. Automatically routes to an alternate provider within 3 minutes when failures are detected\n3. Ensures high availability and optimal transaction success rates\n\n---\n\n## Mandates\n\n- Originally, only standard one-time payments were supported\n- A dedicated **Mandate Service** was built to support recurring payment mandates\n- The distinction between Darwin and Mandate Service is minimal from an external perspectivethey appear as a unified system\n\n---\n\n# Merchants as Entity in PA\n\n## Merchant Management\n\n- **Merchant Service**: Handles merchant onboarding and management\n- **Jocata**: Used for AML (Anti-Money Laundering) compliance flows\n\n## External Merchant Onboarding\n\n- **First External Merchants**: Dunzo and Swiggy were among the first external merchants\n- **CRED Pay**: Created to serve these merchants, expanding beyond DTPL (which handled bill payments)\n\n## User Experience Components\n\nUser flows such as instrument discovery and reward/offer presentation are critical for external merchants:\n- **Heimdall** (DTPL): Solves user experience challenges\n- **Darwin**: Addresses payment-side requirements\n\n## Settlement Flow\n\n### SCAR (Initial Approach)\nWhen funds hit the escrow account, daily aggregation is required to:\n- Compute MDR (Merchant Discount Rate)\n- Transfer the remaining amount to merchants\n\nA configurable script called **SCAR** was initially created for merchant settlements. SCAR used Heimdall and Genie to identify transactions for aggregation.\n\n### Settlement Engine (Current Approach)\n**Settlement Engine** replaced SCAR to handle settlements properly within DPSPL:\n- **Accounting Module**: Performs transaction aggregation\n- **Tyrion**: Fee rule engine that computes fees\n- **Settlement Calculation**: Determines the final settlement amount\n- **Genie**: Executes the actual fund transfer\n\n## MCC (Merchant Category Code)\n\n- MCC is not standardised across the industry\n- CRED adopted NPCI's MCC definitions for internal use\n- During payment readiness (as part of merchant onboarding), MCC configuration is created for supported payment instruments\n\n---\n\n## LCM (Loading Capability Manager)\n\nLCM validates which payment instruments are permitted for specific transactions and merchants.\n\n### Key Functions\n\n1. **Instrument Validation**: Based on MCC-level payment instrument configuration during merchant onboarding, LCM validates allowed instruments for each transaction/merchant combination.\n\n2. **Historical Context**: Before LCM, Darwin maintained routing logic for each merchant. Unsupported instruments had no routing configuration, causing PA to fail transactions (e.g., credit card used for loan payments).\n\n3. **Terminal Management**: For each new use case, a new terminal is created and configured in LCM.\n\n---\n\n## Key System Components Summary\n\n| Component | Function | Entity |\n|-----------|----------|--------|\n| **Plutus** | Order management & transaction orchestration | DTPL |\n| **Darwin** | Loading/payment collection | DPSPL |\n| **Genie** | Fulfilment/payout execution | DPSPL |\n| **Leia** | Card tokenisation | DPSPL |\n| **MPO** | Darwin wrapper for simplified integration | DTPL |\n| **Narad** | Real-time routing logic | DPSPL |\n| **Settlement Engine** | Settlement aggregation & calculation | DPSPL |\n| **Tyrion** | Fee rule engine | DPSPL |\n| **LCM** | Loading capability management | DPSPL |\n| **Heimdall** | User flows (instrument discovery, rewards) | DTPL |\n| **ComponentX** | SDK orchestration | - |\n| **Merchant Service** | Merchant onboarding/management | DPSPL |\n| **Jocata** | AML compliance | External |\n","structuredPatch":[],"originalFile":null}}
{"parentUuid":"f3fda6bc-0086-4335-9e67-327d64a8de68","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","slug":"harmonic-yawning-mitten","message":{"model":"claude-opus-4-5-20251101","id":"msg_bdrk_01S6VQeKw8PHiSXXRVA7Qy37","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"I've created the refined markdown document. Let me provide a summary of the improvements made to the user.","signature":"EpQCCkgICxABGAIqQGlU22l8Z8aP11mataeYLYWF3TtQseLpyycXMaOEto09P2bVGAgiII381OqYdz3pAoLBEA7iVYBd0Ih9+SYT5d8SDENE+D7vLO2r7VgUqBoMj5cNGoa9iPzfH5YIIjBpOpRD+5ugXg+G8AYfUSHJgDGHxfheHYJdwd8LtHp7S/LKt06tWnJhU/MbZ45+q9Aqeh4C+1UayA45JHF0P5shgxRU/ihECQDx5nYCBtBk2hysPvdc3L3e0gVYSCZ6kSQ51ba5KnsKd7pLKkt9h0j+7tHQoMPQhWw2o5Bi97HhmatTBXuY2wiwgh9rgh9Zma2zKus8HRX5XTs4z5TarDlQPahQ0G08Xtmu7G5lGAE="}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":7,"cache_creation_input_tokens":3217,"cache_read_input_tokens":64300,"cache_creation":{"ephemeral_5m_input_tokens":3217,"ephemeral_1h_input_tokens":0},"output_tokens":4}},"type":"assistant","uuid":"f6b0c078-2947-422d-82c7-efbfac3d0913","timestamp":"2025-12-31T06:21:23.081Z"}
{"parentUuid":"f6b0c078-2947-422d-82c7-efbfac3d0913","isSidechain":false,"userType":"external","cwd":"/Users/kiranbiliyawala/code/cred/payments","sessionId":"1e317d1a-fa25-4272-ab5f-33486c976d47","version":"2.0.76","gitBranch":"","slug":"harmonic-yawning-mitten","message":{"model":"claude-opus-4-5-20251101","id":"msg_bdrk_01S6VQeKw8PHiSXXRVA7Qy37","type":"message","role":"assistant","content":[{"type":"text","text":"Created `Payments_Evolution.md` with the following improvements:\n\n**Language & Structure Improvements:**\n- Added clear section separators and consistent heading hierarchy\n- Improved sentence clarity and grammar throughout\n- Converted informal notes into professional technical documentation\n- Added contextual explanations for acronyms (MDR, MCC, AML, etc.)\n\n**Content Organization:**\n- Grouped related concepts under logical subsections\n- Added a **Key System Components Summary** table at the end for quick reference\n- Structured numbered lists with descriptive headers where appropriate\n- Separated inline notes into distinct bullet points for readability\n\n**Preserved Details:**\n- All technical information retained (12-13 payout partners, 30K crore volume, 60% C-UPI, etc.)\n- All system names and their relationships maintained\n- Migration paths and historical context preserved\n- Regulatory context (RBI guidelines, nodal vs escrow accounts) fully documented\n\nThe document is now at `/Users/kiranbiliyawala/code/cred/payments/Payments_Evolution.md`."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":7,"cache_creation_input_tokens":3217,"cache_read_input_tokens":64300,"cache_creation":{"ephemeral_5m_input_tokens":3217,"ephemeral_1h_input_tokens":0},"output_tokens":268}},"type":"assistant","uuid":"424d485e-307f-4401-94c0-11f726616a59","timestamp":"2025-12-31T06:21:27.274Z"}
{"type":"summary","summary":"Refine Payments Evolution doc to markdown","leafUuid":"424d485e-307f-4401-94c0-11f726616a59"}
